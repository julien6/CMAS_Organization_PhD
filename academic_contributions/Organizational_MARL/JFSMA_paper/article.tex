\documentclass[contribution]{jfsma}

\usepackage[T1]{fontenc}
\usepackage{graphicx}
%\usepackage{color}
%\renewcommand\UrlFont{\color{blue}\rmfamily}
\usepackage{amsthm}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{tabularx}
\usepackage{caption}
\usepackage{listings}
% \usepackage{titlesec}
% \usepackage[english]{babel}
% \captionsetup{font=it}
\usepackage{ragged2e}
\usepackage{xurl}
\usepackage{hyperref}
\usepackage{pifont}
\usepackage{footmisc}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{algorithm2e}
\usepackage{float}
\usepackage{listings}
\usepackage{xcolor}
% \usepackage[inline, shortlabels]{enumitem}
% \usepackage[hyphens]{url}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
 
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}
 
\lstset{style=mystyle}

% --- Tickz
\usepackage{physics}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{tabularx}
\usepackage{extarrows}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}

% ---------
% \usepackage{titlesec}
\usepackage{pdfpages}
\usepackage{booktabs}
\usepackage{csquotes}
\usepackage{lipsum}  
\usepackage{arydshln}
\usepackage{smartdiagram}
\usepackage[inkscapeformat=png]{svg}
\usepackage{textcomp}
\usepackage{tabularray}\UseTblrLibrary{varwidth}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{cite}
\usepackage{amsmath}
\newcommand{\probP}{\text{I\kern-0.15em P}}
\usepackage{etoolbox}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}

\setlength\tabcolsep{0.5pt}

\newcommand{\before}[1]{\textcolor{red}{#1}}
\newcommand{\after}[1]{\textcolor{green}{#1}}

\newcommand{\old}[1]{\textcolor{orange}{#1}}
\newcommand{\rem}[1]{\textcolor{red}{#1}}
\newcommand{\todo}[1]{\textcolor{orange}{\newline \textit{\textbf{TODO:} #1}} \newline \newline }



\newcounter{relation}
\setcounter{relation}{0}
\renewcommand{\therelation}{\arabic{relation}}
\newcommand{\relationautorefname}{Relation}

\newenvironment{relation}[1][]{%
    \refstepcounter{relation}%
    \noindent \raggedright \textit{\textbf{Relation. \therelation}} \hfill$}
{%
$ \hfill \phantom{x}

}

\newcounter{proof}
\setcounter{proof}{0}
\renewcommand{\theproof}{\arabic{proof}}
\newcommand{\proofautorefname}{Proof}

\renewenvironment{proof}[1][]{
    \refstepcounter{proof}
    \noindent \raggedright \textit{\textbf{Proof. \theproof}}

    \setlength{\leftskip}{1em}

}
{

\
\setlength{\leftskip}{0pt}
}


\titre{Une Approche basée sur l'Apprentissage par Renforcement pour l'Ingénierie Organisationelle d'un SMA}


\auteur{Julien Soulé\up{a,b}}{julien.soule@lcis.grenoble-inp.fr}
\auteur{Jean-Paul Jamont\up{a}}{jean-paul.jamont@lcis.grenoble-inp.fr}
\auteur{Michel Occello\up{a}}{michel.occello@lcis.grenoble-inp.fr}
%%%Si besoin d'ajouter des auteurs à la ligne :
\auteurSuite{Louis-Marie Traonouez\up{b}}{louis-marie.traonouez@thalesgroup.com}
\auteurSuite{Paul Théron\up{c}}{paul.theron@orange.fr}

\institution{\up{a}%
  Univ. Grenoble Alpes, Grenoble INP, LCIS, 26000, Valence, France}
\institution{\up{b}%
  Thales Land and Air Systems, BU IAS, Rennes, France}
\institution{\up{c}%
  AICA IWG, La Guillermie, Franc}

% TODO: est-ce qu'on peut utiliser "dissemination" alors que le papier AIAI n'est pas publié à proprement parler?

\begin{document}

\maketitle

\begin{resume}

  Les SMAs de Cyberdéfense  doivent assurer la protection de systèmes en réseaux hétérogènes et distribués allant de la détection d’anomalies à l’exécution de contremesures.
  %
  L’organisation est au coeur de ces SMAs et impacte la façon dont les agents interagissent entre eux et avec leur environnement pour favoriser l’atteinte d’un objectif de Cyberdéfense tout en satisfaisant les contraintes de l’environnement en réseaux.
  %
  Néanmoins, la complexité et le manque de lisibilité de certains systèmes en réseaux rendent difficile et non sûre une recherche empirique d’une organisation adaptée.
  %
  La recherche d’une organisation adéquate est un problème  rencontré pour la conception de la plupart des SMAs et dépasse la problématique de ces applications spécifiques.
  %
  Cet article propose une approche générique et un outil permettant de faciliter la conception de l’organisation en combinant un processus d’apprentissage par renforcement et un modèle organisationnel. L’outil permet de suggérer au concepteur d’un SMA des spécifications organisationnelles.

  %--

  %A l'origine de ce travail sont les SMAs de Cyberdéfence\footnote{Travaux issus des collaborations entre le groupe \emph{AICA IWG} (Autonomous Intelligent Cyberdefense Agent International Work Group) et la chaire Cyber Résilience Aérospatiale de l’Armée de l’Air} qui doivent assurer la protection de systèmes en réseaux hétérogènes et distribués allant de la détection d'anomalie à l’exécution de contremesures.
  %
  %Etant au coeur d'un tel SMA, l’organisation impacte la façon dont les agents interagissent entre eux et avec leur environnement pour favoriser l'atteinte d'un objectif de Cyber-défense tout en satisfaisant les contraintes de l'environnement en réseaux.
  %
  %Néanmoins, la complexité et le manque de lisibilité de certains systèmes en réseaux rendent difficiles et non-sûres une recherche empirique d'une organisation adaptée.
  %
  %La recherche d'une bonne organisation est un problème rencontré pour la conception de la plupart des SMAs. Cet article propose une approche et un outil permetant de faciliter la conception de l'organisation en combinant un processus d'apprentissage par renforcement et un modèle organisationnel. L'outil permet de suggérer au concepteur d'un SMA des spécifications organisationnelles.

  %--

  % Les SMA de Cyberdéfence\footnote{Ce travail est financé par la chaire Cyber Résilience Aérospatiale de l’Armée de l’Air} doivent être déployés sur
  % des systèmes hôtes pour détecter, identifier et caractériser des
  % anomalies/attaques, élaborer et piloter l’exécution de contre
  % mesures et dialoguer avec l’extérieur. 
  % Etant au coeur d’un SMAC, l’organisation impacte la façon
  % dont les agents interagissent entre eux et avec leur environ-
  % nement pour atteindre un objectif de Cyber-défense. Ainsi, la
  % conception d’un SMAC de type AICA peut être vu comme
  % un problème d’optimisation consistant à trouver l’organisation
  % satisfaisant les contraintes de déploiement de l’environnement
  % et favorisant la meilleure performance dans l’atteinte d’un
  % objectif de Cyber-défense. Néanmoins, la complexité et le
  % manque de lisbilité de certains systèmes en réseaux rend
  % difficile et non-sûre une recherche empirique de l’organisation
  % optimale directement sur le système à proteger.

  % Dans le cadre de la recherche sur les \textquote{Autonomous Intelligent Cyberdefense Agents} initiée dans le cadre de l'OTAN, un Système Multi-Agent (SMA) de Cyberdéfense a été proposé pour addresser les défis posés par la Cyberdéfense dans les systèmes en réseaux hétérogènes et distribués.
  % L'efficacité d'un tel SMA pour atteindre un objectif de Cyberdéfense dépend de l'organisation induite via les agents par le concepteur d'après sa connaissance empirique de l'environnement en réseaux. Cependant, cette connaissance peut s'averer insuffisante pour établir un SMA capable de répondre aux attentes compte tenu de la taille, du manque d'appréhension et des spécificités de certains environnements.
  %Au delà du cadre de la Cyberdéfense, la complexité ou la faible lisibilité de certains environnements rendent difficile la conception de SMA sur la seule base de l'experience du concepteur.
  %Afin de faciliter la conception de l'organisation, nous introduisons \emph{Assisted Organization MAS Engineering Approach} (AOMEA). AOMEA s'appuie sur la combinaison d'un processus de \emph{Multi-Agent Reinforcement Learning} (MARL) avec un modèle organisationnel pour suggérer des spécifications organisationnelles pertinentes pour aider à l'ingénierie SMA.
\end{resume}

\motscles{Organisations, Ingénierie multi-agents, Simulation multi-agents, Apprentissage multi-agents}

\bigskip

\begin{abstract}

  The Cyberdefense MASs must ensure the protection of heterogeneous and distributed networked systems ranging from anomaly detection to countermeasure execution.
  %
  Organization lies at the core of these MASs and impacts how agents interact with each other and their environment to foster the achievement of a Cyberdefense objective while meeting the constraints of the networked environment.
  %
  However, the complexity and lack of readability of some networked systems make difficult and unsafe an empirical search for a suitable organization.
  %
  The search for an adequate organization is a problem encountered in the design of most MASs and goes beyond the issues of these specific applications.
  %
  This article proposes a generic approach and a tool to facilitate the organization's design by combining a reinforcement learning process and an organizational model. The tool suggests organizational specifications to the designer of an MAS.
\end{abstract}

\keywords{Organizations, Multi-agent engineering, Multi-agent simulation, Multi-agent learning}

\section{Introduction}

% Contexte:

La recherche sur les \emph{Autonomous Intelligent Cyberdefence Agents}~\cite{Kott2023} (AICA) a été initiée le cadre du groupe \emph{NATO IST-152} puis de l'\emph{AICA International Work Group}.
Un AICA doit pouvoir être déployé sur un système en réseaux pour détecter, identifier et caractériser des anomalies/attaques, élaborer et piloter l’exécution de contre-mesures et dialoguer avec l’extérieur.
Dans une vision Multi-Agent de l'AICA, des agents de Cyberdéfense coopératifs sont déployés dans un environnement en réseaux pour assurer les fonctionalités d'un agent AICA. Ces agents constituent alors un SMA de Cyberdéfense.
%
%Les méthodes de conception/développement de SMA ont souvent été proposées conjointement à des modèles organisationnels pour aider les concepteurs à trouver des spécifications organisationnelles appropriées permettant à un SMA d'atteindre efficacement un objectif.
%

Pour concevoir un SMA de Cyberdefense, des méthodes de conception telles que GAIA~\cite{Wooldridge2000,Cernuzzi2014}, ADELFE~\cite{Mefteh2015} ou DIAMOND~\cite{Jamont2015}, KB-ORG~\cite{Sims2008} fournissent des démarches qui s'appuient sur l'expérience du concepteur pour élaborer les règles de l'agent (également appelées \textbf{politiques}) en tirant parti des mécanismes de \textbf{auto/ré-organization} pour adapter le SMA à l'environnement de déploiement et lui permettre d'atteindre son objectif.
Ces méthodes ont en commun de demander au concepteur de définir les politiques des agents que ce soit d'un point de vue ascendant ou descendant. Un SMA capable d'atteindre un objectif donné pourrait ainsi laisser voir des organisations émergentes ou prédéfinies permettant d'atteindre l'objectif donné~\cite{Picard2009}.

Cette approche générale de conception se déroule souvent sous la forme d’un processus itératif procédant par essais et erreurs. Cependant, il présente les limites suivantes :
%
\begin{itemize}
  \item Cela nécessite des concepteurs suffisamment expérimentés ;
  \item Il peut être coûteux de converger vers un SMA estimé suffisamment performant et adéquat ;
  \item Il devient difficile de l'appliquer à des environnements de déploiement cibles très complexes.
\end{itemize}

En particulier, dans le cas d'un SMA de Cyberdefense, ce dernier devant s'adapter de façon général à un environnement hôte, sa conception se heurte au manque de compréhension visuelle et intuitive des environnements en réseau et de leurs spécificités propres. Il devient alors nécéssaire de s'interesser aux moyens d'assister le processus de conception du SMA de Cyberdéfense.
Plus loin, cette perspective englobe également l'aide à la conception de SMA devant atteindre un objectif dans un environment ne pouvant pas être appréhendé facilement par manque d'intuitivité, de visualiation ou encore en raison d'une grande complexité.

Une façon d'envisager la conception d'un SMA est au travers du concept d'organisation d'un SMA en ce qu'il impacte la manière dont les agents coordonnent leurs activités pour atteindre de manière collaborative un objectif commun~\cite{Hubner2007}. Même implicite, l'organisation vue comme le résultat des interactions entre agents, peu notamment permettre à SMA de s'adapter à des environnements dynamiques et incertains en adoptant un comportement d'exécution flexible~\cite{Kathleen2020}.


un problème d’optimisation consistant à trouver l’organisation
satisfaisant les contraintes de déploiement de l’environnement
et favorisant la meilleure performance dans l’atteinte d’un
objectif de Cyber-défense.

% Ces méthodes sont couramment appliquées par le biais de simulations car elles permettent un cadre de surveillance sûr pour le processus de conception et l'évaluation. Un SMA développé dans des environnements simulés avec une haute fidélité au système cible devrait être transféré au système cible pour fonctionner de manière adéquate~\cite{Schon2021}.



% Problème:

Même si certaines méthodes peuvent automatiser certaines parties de la conception de l'organisation SMA, comme KB-ORG~\cite{Sims2008}, elles nécessitent néanmoins certaines connaissances et interactions manuelles pour guider le processus de conception. En effet, il est nécessaire de :

\begin{itemize}
  \item Trouver automatiquement les politiques des agents adaptées satisfaisant les contraintes de conception ;
  \item Rendre explicites les mécanismes organisationnels qui émergent des agents entrainés pour le processus de conception.
\end{itemize}

% Contribution

Dans ce contexte, nous introduisons AMOEA, une approche de conception SMA dont l'idée sous-jacente est de lier un processus MARL donné à un modèle organisationnel qui relie les politiques des agents en entraînement à des spécifications organisationnelles explicites. AOMEA peut être considéré comme un outil d'ingénierie permettant de générer automatiquement des spécifications organisationnelles exploitables pertinentes uniquement en ce qui concerne la performance dans la réalisation de l'objectif donné et les contraintes de conception. Pour le concepteur, les spécifications organisationnelles obtenues sont un aperçu des mécanismes organisationnels à mettre en place pour développer un SMA répondant aux exigences de performance.

% Résultats

% Nous avons appliqué AOMEA dans trois jeux Atari spatiaux avec différents degrés de coopération requis entre les agents afin qu'ils atteignent un objectif le plus efficacement possible ; et en outre en respectant les spécifications organisationnelles comme contraintes de conception. Les spécifications organisationnelles obtenues sont en effet exploitables, cohérentes avec les attentes et respectent les contraintes de conception.
%Nous avons également appliqué notre approche, dans un environnement d'essaim de drones de Cyberdéfense dont les spécifications organisationnelles résultantes ont conduit à développer un SMA avec des scores comparables aux principaux.

La section II commence par présenter le contexte théorique d'AOMEA et se concentre sur les concepts fondamentaux que nous avons utilisés pour les modèles organisationnels et MARL.
% et la motivation pour intégrer un modèle organisationnel SMA dans un processus MARL afin d'améliorer le processus de conception SMA.
Dans la section III, nous présentons AOMEA depuis l’approche jusqu’à l’outil mis en œuvre. Nous avons évalué AOMEA dans quatre environnements simulés et discuté des résultats obtenus dans la section IV. Enfin, la section V conclut sur la viabilité d'AOMEA, met en évidence les limitations et les travaux futurs.

% ================================================== =================================================== =

\section{Contexte théorique}

% // Mettre en avant les briques du raisonnement en raison du titre pour préparer l'introduction de la contribution avec AOMEA sans les justifier (sans faire de comparaison avec l'existant, pas d'édt, dire juste les points forts)

% Organisation
% -> moise (justificateur parmi les existants)

% Méthodologies SMA (ALAADIN, GAIAI mais pas de moyens pour trouver une organisation automatiquemenet)

% MARL (basiques) // DECPOMDP (basiques)

Nous présentons les bases du modèle organisationnel $\mathcal{M}OISE^+$ et les bases MARL sur lesquelles est construite notre contribution.

\subsection{Contexte des systèmes multi-agents}

% définition, modèle AEIO, focus Moise, Dec-POMDP

% Un agent est une entité immergée dans un environnement qui perçoit l'observation et prend la décision d'agir de manière autonome dans l'environnement pour atteindre les objectifs qui lui sont assignés.
% Les types d'agents incluent des agents réactifs pilotés par les événements pour gérer les incertitudes dans un environnement ou des agents cognitifs proactifs qui exploitent les interactions avec d'autres agents. Un SMA est un ensemble d'agents dans un environnement partagé où chaque agent n'a qu'une perception locale. Ces agents doivent être dotés de capacités d'auto/réorganisation qui leur permettent de modifier de manière adaptative leur structure organisationnelle en fonction de leur environnement.

Un SMA est fortement lié à l'entité de l'organisation (ou simplement \textbf{organisation}) que nous considérons toujours exister à travers les interactions des agents en cours d'exécution même s'elle peut être implicite.
%
% Ces méthodes sont essentielles pour garantir que SMA puisse coordonner, communiquer et exécuter efficacement des tâches dans un environnement distribué et souvent dynamique.
% Les méthodes les plus remarquables incluent
% \emph{Tropos} qui est une méthodologie de développement logiciel orientée agent qui met l'accent sur l'analyse précoce des exigences et l'affinement continu de ces exigences tout au long des phases de conception et de mise en œuvre~\cite{Bresciani2004} ;
% \emph{Gaia}, une méthodologie pour l'analyse et la conception de SMA, axée sur la structure organisationnelle du système~\cite{Zambonelli2003} ; \emph{DIAMOND} qui s'appuie sur une approche itérative en quatre phases pour améliorer le développement de systèmes physiques multi-agents ; et {ADELFE} qui utilisent les compétences et les attitudes lors de la conception pour créer des systèmes auto-organisés et répondre aux exigences finales.
% Dans le cadre des travaux méthodologiques, il convient également de noter le modèle AEIO (Voyelles) qui met l'accent sur la structuration des entités au sein des systèmes multi-agents en incorporant les agents, l'environnement, les interactions et l'organisation comme composants clés.
%
Un \textbf{modèle organisationnel} spécifie (au moins partiellement) l'organisation : si l'organisation est connue explicitement, le modèle organisationnel sert de support à son implémentation ; si l'organisation est émergente, le modèle organisationnel sert de support à sa description. Nous faisons référence aux \textbf{spécifications organisationnelles} comme les composants utilisés dans un modèle organisationnel pour caractériser l'organisation.
En particulier, les notions de roles, de groupes/équipes, et de normes sont fréquement utilisés dans les modèles organisationnels.
% tels que AGRE, $\mathcal{M}OISE^+$, OMNI, OperA, and TÆMS~\cite{Lacomme2011}.

% \input{tables/organizational_models.tex}

% Les modèles ISLANDER, OMNI ou OperA proposent une approche normative du SMA où les agents sont associés à des rôles de façon dynamique ce qui n'est pas couvert par $\mathcal{M}OISE^+$. Néanmoins, 

$\mathcal{M}OISE^+$~\cite{Hubner2007} apparait adapté pour lier les politiques des agents à des spécifications organisationnelles.
Le cadre complet et formel permet une description détaillée sur les aspects structurels, fonctionels et normatifs là où \emph{AGRE}~\cite{Ferber2004}, ISLANDER~\cite{Esteva2002}, OMNI~\cite{Dignum2005} ou STEAM~\cite{Tambe1999} peuvent présenter des capacités limités de description ou sont moins avancées.
% ODML est conçu pour la dynamique organisationnelle des SMA et peut manquer de généricité pour comparer plusieurs SMAs entre eux.
Les modèles STEAM et TÆMS~\cite{Vincent2000} se basent respectivement sur les notions d'équipe et de tâche pour décrire la réponse fonctionnelle du SMA tandis que les aspects normatifs et structurels sont peu couverts.
$\mathcal{M}OISE^+$ considère trois types de spécifications :

Les \textbf{spécifications structurelles} décrivent les moyens que les agents peuvent exploiter pour atteindre un objectif. Il comprend l'ensemble des \emph{rôles}, des sous-groupes, des \emph{liens} intra-groupe et inter-groupe, des \emph{compatibilités} intra-groupe et inter-groupe, ainsi que le rôle et le sous-groupe \emph {cardinalités}.
Un \emph{link} indique si deux rôles sont liés en raison de liens de connaissance, de communication ou d'autorité. Une \emph{compatibilité} indique si deux rôles peuvent être adoptés par le même agent. Les \emph{cardinalités} de rôle et de sous-groupe font respectivement référence au nombre minimal et maximal de rôles et de sous-groupes.

Les \textbf{spécifications fonctionnelles} décrivent la manière d'atteindre un objectif. Il comprend des \emph{schèmes sociaux} et des \emph{ordre de préférence}. Un \emph{schéma social} est décrit par des objectifs globaux, des étiquettes de mission avec des plans et le cardinal des agents engagés dans une mission. Un \emph{ordre de préférence} signifie qu'un agent a une préférence sociale de s'engager dans une mission spécifique parmi plusieurs possibles.

Les \textbf{spécifications déontiques} permettent de relier les spécifications fonctionnelles et structurelles à travers un ensemble de \emph{permissions} et d'\emph{obligations}. Une \emph{permission} signifie qu'un agent jouant le rôle $\rho_a$ est autorisé à s'engager dans la mission $m$ pour une contrainte de temps donnée $tc$. De même, une \emph{obligation} signifie qu'un agent jouant le rôle $\rho_a$ doit s'engager dans la mission $m$ pour une contrainte de temps donnée $tc$. Une contrainte de temps $tc $ spécifie un ensemble de périodes déterminant si une autorisation ou une obligation est valide.

% Pourtant, ces travaux méthodologiques s'appuient largement sur l'expérience des concepteurs humains alors qu'aucun d'entre eux ne permet d'automatiser l'assistance au processus de conception SMA en garantissant une efficacité suffisante tout en prenant en compte les aspects organisationnels dans un contexte multi-agents.

\subsection{Bases du MARL}

L'apprentissage par renforcement est un paradigme d'apprentissage automatique dans lequel les agents apprennent à prendre des décisions en interagissant avec un environnement. L’objectif est que l’agent maximise la récompense cumulée au fil du temps grâce à un processus d’essais et d’erreurs.
MARL étend ce concept à plusieurs agents qui apprennent simultanément à adapter leurs stratégies tout en considérant les actions et les influences des autres agents. Cela pousse les agents à s’appuyer sur des mécanismes de coopération, de compétition et de coordination.

MARL permet de converger automatiquement vers les politiques des agents qui permettent d'atteindre l'objectif donné. Pourtant, contrairement à la conception basée sur l'humain, la logique des agents entrainés n'est pas explicitement spécifiée d'un point de vue collectif. Peu de travaux tentent d’aborder cette question et peu sont orientés à des fins méthodologiques.
Kazhdan et. al.~\cite{Kazhdan2020} a proposé des moyens pour extraire des modèles symboliques des systèmes MARL qui améliorent l'interprétabilité des systèmes MARL.
Wang et. al.~\cite{Wang2020} a introduit une approche MARL orientée rôles dans laquelle les rôles sont émergents et les agents ayant des rôles similaires ont tendance à partager leur apprentissage et à se spécialiser dans certaines sous-tâches.
Tosic et. al~\cite{Tosic2010} a proposé un cadre pour aborder la coordination dans les SMA collaboratifs en s'appuyant sur les capacités de communication des systèmes multi-agents.
Zheng et. al.~\cite{Zheng2018} a présenté une plateforme pour MARL qui vise à faciliter la recherche sur l'intelligence collective artificielle en fournissant un ensemble complet dde mesures d'évaluation pour comparer les performances d'algorithmes MARL.

Des modèles markoviens sont nécessaires pour modéliser l'environnement et appliquer les techniques MARL. En tant qu'outil couramment utilisé, le Decentralized Dec-POMDP~\cite{Oliehoek2016} considère plusieurs agents de la même manière SMA. Il s'appuie sur des processus stochastiques pour modéliser l'incertitude de l'environnement pour les changements induits par les actions, les observations reçues, mais aussi les communications. Sa fonction de récompense est commune aux agents ce qui favorise la formation d'actions orientées pour la collaboration~\cite{Beynier2013}. Formellement, un Dec-POMDP est un 7-tuple $(S,\{A_i\},T,R,\{\Omega_i\},O,\gamma)$ , où : $S = \{s_1, .. s_{|S|}\}$ : L'ensemble des états possibles ; $A_{i} = \{a_{1}^{i},..,a_{|A_{i}|}^{i}\}$ : L'ensemble des actions possibles pour l'agent $i$ ; $T$ pour que $T(s,a,s') = \probP{(s'|s,a)}$ : L'ensemble des probabilités de transition conditionnelles entre les états ; $R : S \times A \times S \rightarrow \mathbb{R}$ : La fonction de récompense ; $\Omega_{i} = \{o_{1}^{i},..,o_{|\Omega_{i}|}^{i}\}$ : l'ensemble d'observations pour l'agent $ag_i$ ; $O$ pour que $O(s',a,o) = \probP{(o|s',a)}$ : L'ensemble des probabilités d'observation conditionnelles ; $\gamma \in [0,1]$, le facteur de remise.

Nous appelons \textbf{résoudre} le Dec-POMDP pour l'équipe $t$ la recherche d'une politique conjointe $\pi_{joint,i} \in \Pi_{joint}$ qui maximise la récompense cumulée attendue sur un horizon fini.
Nous faisons référence à la \textbf{résolution sous-optimale} du Dec-POMDP à une espérance de $s$ comme étant la recherche des politiques conjointes $\pi_{joint,i} \in \Pi_{joint}$ qui obtiennent la récompense cumulative attendue sur une épisode à une espérance minimale ou égale à $s \in \mathbb{R}$.


% ================================================== =================================================== =

\section{Approche AOMEA}

% Mettre d'abord en avant le shcéma général de l'approche
% Donner la philosophie de l'approche

% 	Aperçu global (Fig. 1)
% 	noyau théorique
% 	Ingénierie
% Implémentation (vers une implémentation de type PoC)

\subsection{Vue d'ensemble}

\begin{figure}[h!]
  \centering
  \include{figures/approach}
  \caption{Une vue récapitulative de notre approche de la conception SMA}
  \label{fig:design_approach}
\end{figure}

Nous présentons AOMEA comme une approche de conception de SMA qui automatise la conception préliminaire d'un SMA en fonction de certaines contraintes de conception. Les spécifications organisationnelles obtenues après l'entrainement permettent l’élaboration d’un SMA raffiné.
L’idée sous-jacente de notre approche est de considérer qu’une politique conjointe ou un historique conjoint peuvent être décrites en termes de spécifications organisationnelles, au moins partiellement.
Nous appelons cette approche large \textquote{Organization oriented MARL} (OMARL).
%
% En tant que description de haut niveau, AOMEA considère l'environnement avec des agents qui doivent atteindre certains objectifs. Il permet de trouver automatiquement des informations pertinentes sous la forme de spécifications organisationnelles. Ils doivent exprimer de manière transparente comment les agents pourraient agir et collaborer individuellement pour atteindre les objectifs. Le processus de conception du SMA peut alors être assisté à la lumière de ces indications. Une représentation illustrative de notre approche est présentée dans \autoref{fig:design_approach}.
%
AOMEA se compose de 4 phases séquentielles : modélisation, résolution, analyse et développement (respectivement $1.x$, $2.x$, $3.x$, $4.x$ dans les étiquettes de flèche dans \autoref{fig:design_approach}).

\textbf{Phase 1 : Modélisation} \quad Dans cette phase, le concepteur doit développer manuellement une simulation de l'environnement cible ($1.1$ dans \autoref{fig:design_approach}) où les agents doivent coopérer pour atteindre efficacement l'objectif du concepteur ($1.2 $ in \autoref{fig:design_approach}) à l'aide de retours quantitatifs. Lors du développement de l'environnement simulé, le concepteur peut relier des parties de la politique d'un agent (sous forme de couples observations-actions) avec les spécifications organisationnelles connues de tout modèle organisationnel choisi.
Par exemple, dans les organisations \textquote{leader-follower}, les actions qui envoient des ordres à d'autres agents suiveurs sont des caractéristiques des agents leaders.
Facultativement, le concepteur peut restreindre l'ensemble des politiques possibles que les agents peuvent explorer par rapport aux spécifications organisationnelles données en tant que contraintes pour répondre aux exigences de conception ou pour aider les agents à converger ($1.3$ dans \autoref{fig:design_approach}).

\textbf{Phase 2 : Résolution} \quad Dans cette phase, en s'appuyant sur les relations établies entre les couples observation-action et les spécifications organisationnelles, un algorithme MARL est utilisé conjointement avec le modèle organisationnel SMA choisi à travers un processus OMARL. Il permet automatiquement de trouver des politiques optimales satisfaisant les spécifications organisationnelles de conception données ($2.1$ dans \autoref{fig:design_approach}) qui conduisent à la meilleure récompense cumulée attendue ; et obtenir les spécifications organisationnelles associées ($2.2$ dans \autoref{fig:design_approach}). Par exemple, lors de l'entrainement des agents concernant l'organisation \textquote{leader-follower}, certains agents peuvent se voir interdire d'envoyer des ordres tandis que d'autres peuvent y être forcés. Après l'entrainement, le processus OMARL caractérise les rôles émergents, les liens entre les rôles ou les sous-objectifs organisés en plans de mission.

\textbf{Phase 3 : Analyse} \quad Dans cette phase, le concepteur observe les politiques des agents entrainés ($3.2$ dans \autoref{fig:design_approach}) et prend en compte les spécifications organisationnelles associées déduites ($3.1$ dans \autoref{fig:design_approach}) pour comprendre comment ces agents peuvent atteindre l'objectif. À la lumière de ces résultats bruts, le concepteur peut extraire des modèles de conception pertinents en excluant les actions bruyantes ou inutiles des agents. L'intérêt est de fournir au moins quelques indications sur les spécifications organisationnelles capables d'atteindre l'objectif et de satisfaire les contraintes de conception. Nous appelons ces indications pertinentes des spécifications organisationnelles raffinées ($3.3$ dans \autoref{fig:design_approach}). Par exemple, après avoir entraîné plusieurs agents dans un environnement \textquote{prédateur-proie}, il est possible d'analyser qu'un prédateur \textquote{leader} avec des prédateurs \textquote{follower}, semble être plus efficace pour attraper des proies.

\textbf{Phase 4 : Développement} \quad Dans cette phase, le concepteur prend en compte les spécifications organisationnelles raffinées comme modèle pour la mise en œuvre d'un SMA. À partir de là, un développement régulier du SMA avec l'une des méthodes disponibles utilisée conjointement avec le modèle organisationnel choisi peut être appliqué. Contrairement aux agents entrainés qui peuvent provoquer des comportements inattendus, les agents implémentés manuellement permettent de donner les garanties de sécurité requises pour les environnements sensibles. Enfin, les agents implémentés sont lancés dans des simulations pour évaluer si le SMA implémenté peut effectivement atteindre l'objectif.

\subsection{Cœur de l'approche}

Pour implémenter un processus OMARL, nous proposons l'algorithme \emph{Partial Relations with Agent History and Organization Model} (PRAHOM) pour lier les politiques des agents et leur entrainement à un modèle organisationnel.
Il s'agit d'une synthèse de deux processus qui entrent dans le cadre des objectifs de l'OMARL. Le premier processus récupère les spécifications des politiques des agents, et le second processus récupère les politiques conjointes satisfaisant les spécifications de conception données. Une vue illustrative de \emph{PRAHOM} est donnée dans \autoref{fig:prahom_process}.
Ici, nous présentons simplement l'idée sous-jacente à une description de haut niveau de ces deux processus afin d'éviter un formalisme inutile. Plus d'informations sur l'utilisation et l'implémentation de \emph{PRAHOM} peuvent être trouvées dans \autoref{PettingZoo-wrapper}.
% Puisque \emph{PRAHOM} s'appuie sur des historiques conjointes plutôt que sur des politiques conjointes, il est indépendant de la fonction d'approximation utilisée pour mettre en œuvre les politiques des agents telles que celles basées sur les réseaux de neurones

\begin{figure}[h!]
  \centering
  \include{figures/prahom_process}
  \caption{Une vue récapitulative du processus PRAHOM}
  \label{fig:prahom_process}
\end{figure}

\paragraph{\textbf{Déduire des spécifications organisationnelles}}

Plutôt que d'utiliser directement les politiques conjointes, nous utilisons les historiques conjoints car ils peuvent être construits avec les actions résultantes observées lorsque les observations sont reçues au cours d'une série d'épisodes de test. En effet, pour une politique donnée $\pi \in \Pi$, l'historique associé est par définition $h \in h_{joint} = \langle(\omega_k,a_k) | k \in \mathbb{N}\rangle$ et le $(\omega_k,a_k) \in \pi$.
Ensuite, en raison de la difficulté de déduire des informations liées aux spécifications organisationnelles, il est possible d'associer chaque observation ou action aux spécifications de l'organisation sous la forme d'une relation \textquote{plusieurs à plusieurs}. Cela met en place un premier cadre d’identification des spécifications organisationnelles dans les historiques. Le reste de cette section addresse cette difficulté.

On peut définir certaines relations entre les spécifications $\mathcal{M}OISE^+$ et les historiques conjoints. Leurs prémisses viennent du fait que certaines spécifications du modèle organisationnel $\mathcal{M}OISE^+$ peuvent être mappées à des sous-ensembles d'actions d'une seule politique commune sous-optimale.
À partir de ces relations, il est possible d’utiliser des approches empiriques ou statistiques pour déduire des spécifications organisationnelles à partir d’historiques communes. Ci-dessous, nous décrivons de manière informelle les points clés de ce processus.

Comme nous n’avons qu’un seul groupe, nous ne considérons pas les inter-liens et les inter-compatibilités. De plus, par souci de simplification, nous ne considérons qu’un seul schème social.
Premièrement, nous examinons le niveau individuel en essayant de comprendre les rôles, les liens, les sous-groupes, les objectifs individuels, les missions et les plans joués par les agents en échantillonnant les sous-séquences historiques $h \in H$ et en les comparant avec les sous-séquences historiques connues dont nous avons besoin. connaître le rôle associé via les relations établies.

Après avoir analysé plusieurs politiques communes, nous essayons de renforcer une vision globale des objectifs, des missions, des plans et de la connaissance de la mission par rapport à l'objectif ; avec les informations partiellement déduites au niveau individuel.
Au final, notre processus tente de synthétiser les connaissances inférées jusqu'à avoir une meilleure vision de la cardinalité des agents par sous-groupe, de la cardinalité des agents pour chaque mission, de la cardinalité des rôles, des compatibilités entre rôles, des autorisations et des obligations.

\paragraph{\textbf{Contraindre l'espace des politiques}}

Nous considérons un algorithme MARL donné qui converge itérativement vers une politique commune de sorte que la politique de chaque agent soit mise à jour à chaque étape jusqu'à un horizon fini.
Nous avons privilégié l'algorithme \emph{Proximal Policy Optimization} pour son efficacité prouvée dans des environnements multi-agents coopératifs sans nécessiter de modifications algorithmiques ou d'architectures spécifiques au domaine~\cite{Yu2022}.
Pour contraindre les politiques conjointes possibles à celles satisfaisant les spécifications organisationnelles de conception $os_{init}$, nous proposons de contraindre les ensembles d'actions et d'observations pour chaque agent en fonction de $os_{init}$ à chaque étape. Par exemple, nous pouvons contraindre un agent à converger vers un rôle donné en interdisant les actions liées à d’autres rôles. Nous avons utilisé cette idée pour mettre en place notre processus visant à guider l'entrainement en fonction des contraintes organisationnelles de conception.

Dans un premier temps, nous utilisons les relations précédemment établies entre spécifications organisationnelles et couples action-observation, pour déterminer les actions autorisées ou interdites jouables par les agents à chaque étape.
Ensuite, il calcule d'abord l'ensemble d'actions autorisées $A_{step}$ en fonction de l'historique actuel $h_{joint,i}$. Ensuite, une action est choisie parmi les actions autorisées. Cette action $a_{step} \in A_{step}$ est ajoutée à l'historique pour être utilisée pour mettre à jour la politique de l'agent à l'étape suivante. Ensuite, l'algorithme MARL met à jour la politique commune, donc les politiques des agents, avec l'action et l'observation en cours.
Enfin, une analyse de la politique conjointe sous-optimale actuelle $\pi_{joint}$ satisfaisant $os_{init}$ est déclenchée périodiquement. Il permet d’améliorer de manière itérative l’efficacité des politiques conjointes et l’exactitude des spécifications organisationnelles qui en découlent.
Nous pouvons noter que la restriction impliquée par $os_{init}$ dans les éventuelles politiques conjointes pourrait empêcher l'algorithme MARL de trouver une politique commune qui satisfasse la récompense cumulative minimale attendue définie par le concepteur.

\subsection{Outil d'ingénierie}

PettingZoo est une bibliothèque qui propose une API standardisée qui simplifie le développement d'environnements avec des agents et facilite l'application des algorithmes MARL.
Nous avons développé \emph{PRAHOM PettingZoo Wrapper}\label{PettingZoo-wrapper}, un outil pour aider à automatiser la configuration de \emph{PRAHOM} pour un environnement PettingZoo donné.
Il s'agit d'une Preuve de Concept qui permet de relier les actions aux spécifications $\mathcal{M}OISE^+$ et de définir les spécifications organisationnelles. Il fournit des fonctions pour extraire les spécifications organisationnelles brutes sous-optimales qui en résultent. Lors de l'entrainement, des actions sont masquées pour guider un agent à apprendre à agir selon les spécifications organisationnelles.

\begin{lstlisting}[language=Python, caption=PRAHOM PettingZoo Wrapper basic use, label={lst:wrapper_basic_use}]
from omarl_experiments import PrahomWrapper
env = PettingZoo_env.parallel_env(render_mode="human")
...
action_to_specs = {"agent_name": {
        "14": "role='leader';link='(agent_0,agent_1,auth);..."
        ...}    
    ...}
training_specs = {
    "leadadversary_0": {
        "must": ["(23,41)"],
        "must_not": ["(14,74)"]}...}
env = PrahomWrapper(env, action_to_specs, training_specs, unknown_specs_inference=True, pca_output=True)
# ...TRAINING...
env.prahom_render_pca()
trained_specs, agent_to_specs = env.prahom_specs()
\end{lstlisting}

Dans \autoref{lst:wrapper_basic_use}, nous avons détaillé une utilisation basique du wrapper pour augmenter un environnement PettingZoo (l.12) avec des relations connues entre les actions et les spécifications organisationnelles (l.4) et les contraintes de conception que les agents doivent satisfaire (l.8). Après l'entrainement, nous pouvons afficher une Analyse en Composantes Principales (ACP) de l'historique de chaque agent sur un épisode (l.14) qui est un outil d'analyse supplémentaire pour détecter manuellement les rôles émergents. Il fournit également les spécifications $\mathcal{M}OISE^+$ déduites en tenant compte des derniers épisodes et de la manière dont les agents sont instanciés dans le dernier épisode.

Ces résultats sont construits via des approches empiriques ou statistiques en utilisant les relations connues entre les observations, les actions et les spécifications organisationnelles. Lorsqu'aucune relation n'est disponible, il tente de détecter des sous-séquences d'historiques communes susceptibles de correspondre à une spécification organisationnelle (l. 12). En raison de ces limitations, les résultats peuvent ne pas décrire entièrement l’organisation sous-jacente ou contenir des spécifications organisationnelles déduites bruyantes. Puisque les résultats sont conformes à $\mathcal{M}OISE^+$, il est alors possible de les utiliser avec les méthodes de conception SMA disponibles pour bénéficier des spécifications organisationnelles émergentes identifiées au cours du processus de conception.

% =============

% \begin{itemize}
% \item Questions au niveau du système multi-agents (approche centrée sur le système)
% \begin{itemize}
% \item Nombre d'agents, quelle hétérogénéité ?
% \item Quel est le support commun (Environnement) partagé par les agents ?
% \item Quels mécanismes de communication sont disponibles pour les agents ?
% \item Quels sont les langages de communication, les ontologies, les protocoles d'interaction utilisés par les agents ?
% \item Quelle est l’organisation au sein de laquelle les agents opèrent ? Comment est-il établi ?
% \item Comment les agents coordonnent-ils leurs actions ? Comment assurer un fonctionnement cohérent ?
% \end{itemize}

% \item Questions au niveau de l'agent (approche centrée sur l'agent)
% \begin{itemize}
% \item Que représente un agent ? Quelles actions doivent être encapsulées dans un agent ?
% \item Comment les agents représentent-ils l'environnement et l'organisation dans lesquels ils opèrent ?
% \item Comment les agents gèrent-ils les interactions avec d'autres agents ?
% \item Quelle est la structure interne des agents ?
% \end{itemize}
% \end{itemize}

% ================================================== =================================================== =

\section{Évaluation dans des environnements de jeu coopératif}

% Évaluation
% Afin de vérifier et démontrer l'approche, est appliquée sur l'étude de cas suivante.
% 	Étude de cas

\subsection{Experimentation}

Afin d'évaluer AOMEA, nous avons envisagé d'utiliser \emph{PRAHOM} dans des environnements simulés disponibles composés d'agents devant atteindre un objectif avec les meilleures performances à travers diverses stratégies collectives dont certaines peuvent être facilement comprises.
Nous avons sélectionné trois environnements de type Atari pour leur rendu visuel qui constitue un moyen pratique d'évaluer les résultats avec des observations manuelles\footnotemark[1].
Considérant la recherche sur les AICA, nous avons également considéré un environnement de Cyberdéfense comme une première tentative d'application de \emph{PRAHOM} dans un environnement de Cyberdéfense non visuel :

\footnotetext[1]{Des explications supplémentaires et les exemples discutés utilisant le \emph{PRAHOM PettingZoo wrapper} sont disponibles sur \url{https://github.com/julien6/omarl_experiments?tab=readme-ov-file\#predator-prey-with-communication}}

\begin{itemize}
  \item \textquote{Drone swarm - 3rd CAGE Challenge}~\cite{cage_challenge_3_announcement} (CYB) se compose d'agents cyberdender déployés sur des drones en réseau essayant de lutter contre les programmes malware déployés de manière malveillante. Nous pouvons nous attendre à ce que les agents \allowbreak isolent collectivement les drones compromis ;
  \item \textquote{Pistonball} (PBL)~\cite{Terry2021} se compose d'une série de pistons pour amener une balle de droite à gauche, nécessitant ainsi la représentation des voisins ;
  \item \textquote{Predator-prey with communication}~\cite{Lowe2017} (PPY) se compose de prédateurs surveillés par un leader pour mieux attraper des proies plus rapides, nécessitant ainsi des stratégies de chasse collectives ;
  \item \textquote{Knights Archers Zombies}~\cite{Terry2021} (KAZ) consiste en trois chevaliers et deux archers apprenant à tuer le plus de zombies ce qui nécessite ainsi un positionnement spatial efficace des agents.
\end{itemize}

Nous avons appliqué AOMEA dans trois cas :
\begin{itemize}
  \item Pas de spécifications organisationnelles (NTS) : les agents doivent apprendre les stratégies collectives les plus efficaces sans aucune contrainte ni indication.
  \item Spécifications organisationnelles partiellement contraignantes (PTS) : certaines contraintes ou indications sont données pour aider à converger plus rapidement ou à répondre à des exigences.
  \item Spécifications organisationnelles entièrement contraignantes (FTS) : des politiques conjointes élaborées manuellement sont données car elles constituent une référence concernant les politiques conjointes apprises.
\end{itemize}

Ici, nous ne présentons pas le détail des contraintes données dans NTS et FTS (disponibles dans le référentiel Git\footnotemark[1]).

\begin{figure}[h!]
  \centering
  \includegraphics[width=\linewidth]{figures/prahom_learning_curve.png}
  \caption{Récompense moyenne pour chaque itération dans l'environnement PBL pour les cas NTS, PTS et FTS}
  \label{fig:prahom_learning_curve}
\end{figure}

\begin{figure}[h!]
  \centering
  \includegraphics[width=\linewidth]{figures/prahom_pca_analysis.png}
  \caption{ACP des historiques des agents entrainés dans l'environnement PBL}
  \label{fig:prahom_pca_analysis}
\end{figure}

Nous évaluons l'impact de \emph{PRAHOM} sur les critères suivants : les ratios de temps de convergence entre PTS, NTS et FTS pour atteindre un seuil de récompense cumulée. La stabilité des performances montre comment les agents entrainés peuvent atteindre l'objectif de façon générale en évaluant plusieurs environnements générés avec différents paramètres. Les résultats sont présentés dans le tableau~\ref{tab:training_AOMEA_results}.
%
\input{tables/training_OMARL_results.tex}

\subsection{Discussion}

De manière générale, on peut remarquer que le temps de convergence est plus long pour NTS que pour PTS qui est également plus long que pour FTS. Comme prévu, l’espace de recherche diminue, d’où un temps de convergence plus court. Par exemple, nous avons remarqué une convergence plus rapide vers une solution sous-optimale dans l’environnement PBL en fournissant des spécifications organisationnelles telles que présentées dans \autoref{fig:prahom_learning_curve}. Bien que le PTS converge plus rapidement que le NTS vers une récompense cumulée comparable, le NTS peut surpasser le PTS parce que les politiques des agents entrainés sont conçues sur mesure pour résoudre le problème de manière beaucoup plus fine que ne peuvent les spécifications organisationnelles du concepteur. Une faible stabilité des performances dans l'environnement CYB indique que les agents entrainés ont des difficultés à trouver des stratégies générales par rapport aux agents des autres environnements.

Nous avons également pris en compte les critères suivants après l'entrainement : rôles, liens et performance globale. Une analyse qualitative est présentée dans le tableau~\ref{tab:trained_AOMEA_results}
%
\input{tables/trained_OMARL_results.tex}
%
% //TODO : schémas Moise+ et comparaison avec ceux attendus
%
Pour l'environnement PBL, nous pouvons remarquer que les rôles sont équivalents car les agents sont censés agir de la même manière. En effet, les historiques des agents entrainés sont proches, montrant ainsi un rôle émergent commun. Nous avons généré l'ACP présentée dans \autoref{fig:prahom_pca_analysis} en exprimant les historiques des agents sous forme de vecteurs contenant les couples observation-action. Nous pouvons remarquer que l'historique de la plupart des agents se trouve dans la zone inférieure gauche (encerclée en rouge). Cela montre que la plupart des pistons semblent agir de la même manière que prévu. Nous n'observons aucune spécification organisationnelle mis à part les rôles générés car les agents ne peuvent pas communiquer. Pour l'environnement KAZ, on peut remarquer deux rôles distincts : les archers ont tendance à s'éloigner des zombies, tandis que les chevaliers ont tendance à s'en approcher. Pour l'environnement PPY, nous pouvons observer que les spécifications de sortie indiquent des liens d'autorité entre le prédateur leader et les prédateurs simples pour permettre des stratégies collectives pour encercler les proies. Enfin, l’environnement CYB montre que les communications entre agents bleus sont bien comprises comme des liens de communication permettant d’isoler les drones infiltrés ou de tenter de réparer et d’alerter les drones récemment suspectés.

Pour l'environnement CYB, nous avons développé notre SMA raffiné via un simple arbre de décision élaboré à la main tel que préconisé dans AOMEA à la lumière des spécifications organisationnelles que nous avons obtenues en supprimant le bruit. Notre approche ne suggère pas de rôles généraux, mais des modèles stratégiques pertinents ont été identifiés. Par exemple, concernant les liens entre les rôles des agents, nous avons remarqué que les agents qui envoient des messages semblent fréquemment repérés comme suspects par leurs voisins. De plus, un agent cyber-défenseur se trouvant dans le rayon de communication d’un drone suspecté a tendance à couper sa communication et à la réactiver par la suite. Même si ces informations sont peu nombreuses, le score moyen que nous avons obtenu avec notre SMA affiné est d'environ -2000, ce qui est en effet proche des 5 meilleurs scores montrant l'applicabilité d'AOMEA à aux contexte de la Cyberdéfense.

\section{Conclusion}

% Dans cet article, nous avons présenté AOMEA, une nouvelle approche générale de conception SMA qui vise à faciliter la conception SMA lorsqu'elle ne peut pas être facilement réalisée par les concepteurs dans des environnements de déploiement très complexes.
Les travaux méthodologiques du SMA s'appuient sur les connaissances du concepteur pour concevoir une organisation SMA adaptée mais ne fournissent pas de moyens automatiques ou assistés pour déterminer les mécanismes organisationnels pertinents.
% uniquement à partir des exigences de conception et de l'objectif global.
Les techniques MARL ont été appliquées avec succès pour entrainer automatiquement des agents à atteindre un objectif donné sans caractérisation explicite des stratégies collectives émergentes.
L'originalité d'AOMEA est d'enrichir un processus MARL d'un modèle organisationnel explicite vers un objectif méthodologique pour aborder ces problématiques. Nous avons d'abord exposé comment AOMEA est destiné à être utilisé dans l'ingénierie SMA en tant qu'outil supplémentaire pour aider au processus de conception.
Ensuite, nous avons expliqué le noyau théorique d'AOMEA avec les liens entre Dec-POMDP et le $\mathcal{M}OISE^+$ à travers le processus \emph{PRAHOM}.
De plus, nous avons implémenté le wrapper \emph{PRAHOM PettingZoo} comme preuve de concept pour appliquer pratiquement AOMEA et nous avons montré qu'il permet d'obtenir des spécifications organisationnelles qui satisfont aux contraintes de conception et permettent d'atteindre l'objectif donné.
Enfin, nous avons appliqué notre approche dans quatre environnements PettingZoo pour évaluer l'impact pendant et après l'entrainement. Les résultats de performance obtenus se révèlent comparables à ceux connus, démontrant que notre approche est viable.

Même si \emph{PRAHOM} est agnostique à l'égard de l'algorithme MARL car il utilise l'historique des agents pour déduire des spécifications organisationnelles, reconstruire a posteriori les comportements collectifs des agents peut s'avérer difficile. En effet, une perspective majeure pour améliorer \emph{PRAHOM} est d'aller plus loin avec les techniques d'apprentissage supervisé et non supervisé en plus des approches statistiques empiriques pour identifier des spécifications organisationnelles pertinentes à partir d'historiques conjointes. De plus, il vaut la peine d’étudier les travaux récents sur les techniques MARL telles que l’apprentissage hiérarchique car ils cherchent déjà à caractériser les stratégies émergentes tout au long de l’apprentissage.
%À terme, nous visons également à améliorer l'applicabilité d'AOMEA en développant des interfaces dédiées construites autour de \emph{PRAHOM} le rendant plus accessible aux contextes industriels et de recherche.


% \begin{thebibliography}{9}
% {\small
% \bibitem{bar} U. Nexpert, \emph{Le livre,} Son Editeur, 1929.

% \bibitem{foo} I. Troiseu-Pami, Un article intéressant, \emph{Journal de
%     Spirou}, Vol. 17, pp. 1-100, 1987
% }
% \end{thebibliography}

{\small
\bibliographystyle{abbrv}
\bibliography{references}
}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-SMAter: "jfsmaLatex"
%%% ispell-local-dictionary: "francais"
%%% TeX-command-extra-options: "-shell-escape"
%%% End: 