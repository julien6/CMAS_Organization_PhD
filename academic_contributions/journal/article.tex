\documentclass[runningheads]{llncs}

\usepackage[T1]{fontenc}
\usepackage{graphicx}
%\usepackage{color}
%\renewcommand\UrlFont{\color{blue}\rmfamily}

\usepackage{amsmath,amssymb,amsfonts}
\usepackage[inline, shortlabels]{enumitem}
\usepackage{tabularx}
\usepackage{caption}
% \usepackage{titlesec}
\usepackage[english]{babel}
\captionsetup{font=it}
\usepackage{ragged2e}
\usepackage{hyperref}
\usepackage{pifont}
\usepackage{footmisc}
\usepackage{multirow}
\usepackage{algorithm2e}

% --- Tickz
\usepackage{physics}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{mathdots}
\usepackage{yhmath}
\usepackage{cancel}
\usepackage{color}
\usepackage{siunitx}
\usepackage{array}
\usepackage{multirow}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{tabularx}
\usepackage{extarrows}
\usepackage{booktabs}
\usetikzlibrary{fadings}
\usetikzlibrary{patterns}
\usetikzlibrary{shadows.blur}
\usetikzlibrary{shapes}

% ---------

\usepackage{pdfpages}
\usepackage{booktabs}
\usepackage{csquotes}
\usepackage{lipsum}  
\usepackage{arydshln}
\usepackage{smartdiagram}
\usepackage[inkscapeformat=png]{svg}
\usepackage{textcomp}
\usepackage{tabularray}\UseTblrLibrary{varwidth}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{cite}
\usepackage{amsmath}
\newcommand{\probP}{\text{I\kern-0.15em P}}
\usepackage{etoolbox}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}

\setlength{\extrarowheight}{2.5pt}

\renewcommand{\arraystretch}{1.7}

\setlength{\extrarowheight}{2.5pt}
\renewcommand{\arraystretch}{0.2}
\renewcommand{\arraystretch}{1.7}

% --------------
% \titleclass{\subsubsubsection}{straight}[\subsection]

% \newcounter{subsubsubsection}[subsubsection]
% \renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
% \renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered

% \titleformat{\subsubsubsection}
%   {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
% \titlespacing*{\subsubsubsection}
% {0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% \makeatletter
% \renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
%   {3.25ex \@plus1ex \@minus.2ex}%
%   {-1em}%
%   {\normalfont\normalsize\bfseries}}
% \renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
%   {3.25ex \@plus1ex \@minus .2ex}%
%   {-1em}%
%   {\normalfont\normalsize\bfseries}}
% \def\toclevel@subsubsubsection{4}
% \def\toclevel@paragraph{5}
% \def\toclevel@paragraph{6}
% \def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
% \def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
% \def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
% \makeatother

% \setcounter{secnumdepth}{4}
% \setcounter{tocdepth}{4}
% --------------

\newcommand{\before}[1]{\textcolor{red}{#1}}
\newcommand{\after}[1]{\textcolor{green}{#1}}

\newcommand{\old}[1]{\textcolor{orange}{#1}}
\newcommand{\rem}[1]{\textcolor{red}{#1}}
\newcommand{\todo}[1]{\textcolor{orange}{\newline \textit{\textbf{TODO:} #1}} \newline \newline }



\newcounter{relation}
\setcounter{relation}{0}
\renewcommand{\therelation}{\arabic{relation}}
\newcommand{\relationautorefname}{Relation}

\newenvironment{relation}[1][]{%
    \refstepcounter{relation}%
    \noindent \raggedright \textit{\textbf{Relation. \therelation}} \hfill$}
{%
$ \hfill \phantom{x}

}

\newcounter{proof}
\setcounter{proof}{0}
\renewcommand{\theproof}{\arabic{proof}}
\newcommand{\proofautorefname}{Proof}

\renewenvironment{proof}[1][]{
    \refstepcounter{proof}
    \noindent \raggedright \textit{\textbf{Proof. \theproof}}

    \setlength{\leftskip}{1em}

}
{

\
\setlength{\leftskip}{0pt}
}

% --------------------------------
%             DOCUMENT
% --------------------------------

\begin{document}
%
\title{An Assisted-Engineering Method for Developing Cyberdefense Multi-Agent Systems}
%
%\titlerunning{Abbreviated paper title}
% If the paper title is too long for the running head, you can set
% an abbreviated paper title here
%
\author{Julien Soulé\inst{1}\orcidID{0000-1111-2222-3333} \and
    Jean-Paul Jamont\inst{1}\orcidID{1111-2222-3333-4444} \and
    Michel Occelo\inst{1}\orcidID{2222--3333-4444-5555} \and
    Louis-Marie Traonouez\inst{2}\orcidID{2222--3333-4444-5555} \and
    Paul Théron\inst{3}\orcidID{2222--3333-4444-5555}}
%
\authorrunning{J. Soulé et al.}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{Univ. Grenoble Alpes, Grenoble INP, LCIS, 26000, Valence, France
    \email{\{julien.soule, jean-paul.jamont, michel.occello\}@lcis.grenoble-inp.fr}
    \and
    Thales Land and Air Systems, BU IAS, Rennes, France
    \email{louis-marie.traonouez@thalesgroup.com}
    \and
    AICA IWG, La Guillermie, France \\
    \email{paul.theron@orange.fr}
}

\maketitle              % typeset the header of the contribution

% TODO:
%  - Se focaliser principalement sur l'explicabilité

\begin{abstract}
    Current Multi-Agent Reinforcement Learning (MARL) algorithms, such as MADDPG and MAPPO, are quantitatively effective in achieving objectives but lack the capability to explain their decision-making processes and ensure compliance with strong constraints. This paper proposes a hybrid approach that integrates MARL with an organizational model derived from the MOISE+ framework. In this approach, organizational specifications, such as roles and missions, are imposed on agents through obligations and permissions. These specifications are associated with expected behaviors, theoretically formalized as sets of histories. This formalization not only links generated histories to known specifications but also constrains agent training to expected behaviors. Consequently, agents constrained by roles and missions are limited in the policies they can develop during training, ensuring that certain constraints are respected, thereby increasing control and safety in the multi-agent system (MAS). Additionally, this approach enhances the interpretability of trained MAS behavior by associating generated histories with known specifications.

    If the generated histories do not correspond to known specifications, we propose the General Organizational Specification Inference Approach (GOSIA). GOSIA infers new organizational specifications, such as roles or missions, from generated histories. To determine roles, it uses hierarchical clustering by measuring how much sequences in the histories share the longest common subsequence (LCS). Policies that produce histories with significant LCS are likely to be abstractly understood as arising from the same role. For missions, GOSIA identifies intermediate states (in terms of observations) that agents pass through before reaching their final states. The idea is to view objectives as intermediate states that all agents effective in reaching the final objective pass through. By collecting joint observations of effective agents, GOSIA identifies common trajectories (via KNN, PCA) by measuring the proximity of observations.

    We demonstrate the effectiveness of this hybrid approach in a cyber environment application, specifically a scenario involving a swarm of drones attacked by malware, based on the CAGE Challenge No. 3.

\end{abstract}


\documentclass[conference]{IEEEtran}

\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{cite}
\usepackage{url}

\title{Explainability in Multi-Agent Reinforcement Learning: Investigating KOSIA and GOSIA Approaches}

\author{Author Name \\
Institution Name \\
Email Address}

\begin{document}

\maketitle

\begin{abstract}
    Explainability in Multi-Agent Reinforcement Learning (MARL) is crucial for understanding and validating the behavior of agents in complex environments. This paper introduces two complementary approaches, KOSIA (Knowledge Organizational Specification Identification Approach) and GOSIA (General Organization Specification Inference Approach), to enhance the explicability of MARL systems. We investigate the strengths and limitations of various techniques for GOSIA, providing a comprehensive evaluation framework. Our contributions address existing gaps in the literature and propose new methodologies for improving transparency in MARL.
\end{abstract}

\section{Introduction}
\label{sec:intro}
\subsection{Background and Motivation}
    \begin{itemize}
        \item Explainability in AI and MARL: Importance and challenges.
        \item Overview of organizational models in MARL, focusing on MOISE+.
    \end{itemize}
    
\subsection{Theoretical and Technical Gaps}
    \begin{itemize}
        \item Lack of systematic approaches to link organizational specifications with agent behavior in MARL.
        \item Need for robust methods to infer organizational structures from agent trajectories.
        \item Challenges in generalizing learned behaviors to new organizational contexts.
    \end{itemize}
    
\subsection{Contributions}
    \begin{itemize}
        \item Introduction of the KOSIA approach to match agent histories with known organizational specifications.
        \item Development of the GOSIA approach for inferring organizational specifications from agent behaviors using advanced clustering and representation techniques.
        \item Comprehensive analysis of various similarity measures and clustering techniques applied within GOSIA.
        \item Experimental validation and comparison of the proposed methods in standard MARL environments.
    \end{itemize}

\section{Related Works}
\label{sec:related}
    \subsection{Explainability in Reinforcement Learning}
        \begin{itemize}
            \item Overview of single-agent explainability techniques.
            \item Transition to multi-agent systems: new challenges and existing solutions.
        \end{itemize}
        
    \subsection{Organizational Models in MAS}
        \begin{itemize}
            \item Introduction to MOISE+ and its application in MAS.
            \item Related works on integrating organizational models with MARL.
        \end{itemize}
        
    \subsection{Explicability in MARL}
        \begin{itemize}
            \item Current state of explainability in MARL.
            \item Gaps in existing approaches and the need for KOSIA and GOSIA.
        \end{itemize}

\section{The KOSIA Approach}
\label{sec:kosia}
    \subsection{Conceptual Framework}
        \begin{itemize}
            \item Definition and scope of KOSIA.
            \item Theoretical basis: linking agent histories to known organizational specifications.
        \end{itemize}
    
    \subsection{Methodology}
        \begin{itemize}
            \item Pattern-matching techniques for identifying organizational specifications.
            \item Implementation details of KOSIA in a MARL setting.
        \end{itemize}
        
    \subsection{Strengths and Limitations}
        \begin{itemize}
            \item Analysis of KOSIA's effectiveness in predefined organizational contexts.
            \item Limitations when organizational specifications are unknown or incomplete.
        \end{itemize}

\section{The GOSIA Approach}
\label{sec:gosia}
    \subsection{Conceptual Framework}
        \begin{itemize}
            \item Definition and scope of GOSIA.
            \item Theoretical basis: inferring new organizational specifications from agent trajectories.
        \end{itemize}
    
    \subsection{Methodology}
        \begin{itemize}
            \item Overview of clustering techniques (e.g., Hierarchical Clustering, K-Means, Gaussian Mixture Models).
            \item Similarity measures for trajectories (e.g., Dynamic Time Warping, Longest Common Subsequence, Edit Distance).
            \item Representation of agent trajectories (e.g., PCA, t-SNE, Autoencoders).
            \item Implementation details of GOSIA in a MARL setting.
        \end{itemize}
        
    \subsection{Analysis of Techniques for GOSIA}
        \begin{itemize}
            \item Comparison of clustering techniques: pros and cons.
            \item Effectiveness of different similarity measures for trajectory comparison.
            \item Evaluation of representation techniques for capturing essential behaviors.
        \end{itemize}

\section{Experimental Setup}
\label{sec:experiment}
    \subsection{Environment and Framework}
        \begin{itemize}
            \item Description of the MARL environments used (e.g., PettingZoo environments).
            \item Integration of KOSIA and GOSIA within the experimental framework.
        \end{itemize}
    
    \subsection{Evaluation Metrics}
        \begin{itemize}
            \item Metrics for assessing explainability and performance.
            \item Criteria for comparing KOSIA and GOSIA outcomes.
        \end{itemize}
        
    \subsection{Results}
        \begin{itemize}
            \item Quantitative results: Performance improvements with KOSIA and GOSIA.
            \item Qualitative analysis: Insights from inferred organizational specifications.
        \end{itemize}
    
    \subsection{Discussion}
        \begin{itemize}
            \item Interpretation of experimental results.
            \item Discussion on the generalizability of KOSIA and GOSIA.
            \item Limitations and potential improvements.
        \end{itemize}

\section{Conclusion and Future Work}
\label{sec:conclusion}
    \begin{itemize}
        \item Summary of contributions: How KOSIA and GOSIA enhance explainability in MARL.
        \item Discussion on the impact of the proposed approaches on MARL research.
        \item Future research directions: Exploring advanced techniques for trajectory analysis, potential application in real-world scenarios.
    \end{itemize}

\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}



\section{Introduction}

Multi-Agent Reinforcement Learning (MARL) has shown great promise in solving complex problems involving multiple interacting agents. However, a significant limitation of current MARL algorithms, such as MADDPG and MAPPO, is the lack of interpretability and the inability to guarantee that agents respect strong constraints. In safety-critical applications like cybersecurity, these limitations can undermine trust in the system's behavior.

This paper introduces a hybrid approach that combines MARL with an organizational model inspired by the MOISE+ framework. The core idea is to impose organizational specifications, such as roles and missions, on agents through obligations and permissions, thereby ensuring that certain constraints are respected during training and deployment. Additionally, we propose the General Organizational Specification Inference Approach (GOSIA) to infer new organizational specifications from generated histories when known specifications are insufficient.

\section{Related Work}

Discuss existing MARL algorithms (e.g., MADDPG, MAPPO), their applications, and limitations in terms of interpretability and constraint satisfaction. Additionally, review existing organizational models for multi-agent systems, particularly MOISE+ and its derivatives.

\section{Hybrid Approach: MARL with Organizational Constraints}

\subsection{Organizational Model Based on MOISE+}
Describe the MOISE+ framework and how it is adapted to impose roles and missions on agents in a MARL environment. Explain the concept of organizational specifications, including obligations and permissions, and how they are associated with expected behaviors.

\subsection{Constraining Agent Training with Organizational Specifications}
Detail how the integration of organizational constraints limits the policies that agents can develop during training. Discuss how this approach increases control and safety in the resulting multi-agent system.

\section{General Organizational Specification Inference Approach (GOSIA)}

\subsection{Inferring Roles from Histories}
Explain the hierarchical clustering technique used to infer roles based on the longest common subsequence (LCS) in generated histories. Discuss the rationale behind considering policies with significant LCS as belonging to the same role.

\subsection{Inferring Missions from Histories}
Describe how GOSIA identifies intermediate states (observations) that agents pass through before reaching their final states. Detail the use of K-Nearest Neighbors (KNN) and Principal Component Analysis (PCA) to determine common trajectories and infer missions.

\section{Case Study: Cyber Defense Scenario}

\subsection{CAGE Challenge No. 3: Swarm of Drones Attacked by Malware}
Provide an overview of the CAGE Challenge No. 3, which involves a swarm of drones under cyber attack. Explain how the hybrid approach was applied to this scenario and the results achieved.

\subsection{Experimental Results}
Present experimental results demonstrating the effectiveness of the hybrid approach in constraining agent behavior, improving safety, and enhancing interpretability in the cyber defense scenario.

\section{Conclusion}

Summarize the key contributions of the hybrid approach and GOSIA. Discuss the implications for developing safe and interpretable multi-agent systems, particularly in cybersecurity applications. Suggest potential future work, including further refinement of the GOSIA technique and exploration of additional application domains.

\section*{Acknowledgment}

This work was supported by \emph{Thales Land Air Systems} within the framework of the \emph{Cyb'Air} chair and the \emph{AICA IWG}


\section*{References}

% \bibliographystyle{abbrv}
\bibliographystyle{splncs04}

\bibliography{references}

% \newpage

% \section*{Annexes}

% \subsection*{Action constraining during training implies result joint-policy constraining}
% \input{proofs/jpc_to_ac.tex}

\end{document}
