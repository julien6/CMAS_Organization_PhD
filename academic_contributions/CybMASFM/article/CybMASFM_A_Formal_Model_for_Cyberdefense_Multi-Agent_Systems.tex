\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage[inline, shortlabels]{enumitem}
\usepackage{tabularx}
\usepackage{caption}
\usepackage{titlesec}
\usepackage[T2A,T1]{fontenc}
\usepackage[english]{babel}
\captionsetup{font=it}
\usepackage{ragged2e}
\usepackage{hyperref}
\usepackage{pifont}
\usepackage{footmisc}
\usepackage{multirow}
\usepackage{pdfpages}
\usepackage{booktabs}
\usepackage{csquotes}
\usepackage{lipsum}  
\usepackage{arydshln}
\usepackage{smartdiagram}
\usepackage[inkscapeformat=png]{svg}
\usepackage{textcomp}
\usepackage{tabularray}\UseTblrLibrary{varwidth}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\usepackage{cite}
\usepackage{amsmath}
\newcommand{\probP}{\text{I\kern-0.15em P}}
\usepackage{etoolbox}
\patchcmd{\thebibliography}{\section*{\refname}}{}{}{}

\setlength{\extrarowheight}{2.5pt}

% \renewcommand{\arraystretch}{1.7}

% \setlength{\extrarowheight}{2.5pt}
% \renewcommand{\arraystretch}{0.2}
% \renewcommand{\arraystretch}{1.7}

% --------------
\titleclass{\subsubsubsection}{straight}[\subsection]

\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}
\renewcommand\theparagraph{\thesubsubsubsection.\arabic{paragraph}} % optional; useful if paragraphs are to be numbered

\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{5}{\z@}%
  {3.25ex \@plus1ex \@minus.2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\renewcommand\subparagraph{\@startsection{subparagraph}{6}{\parindent}%
  {3.25ex \@plus1ex \@minus .2ex}%
  {-1em}%
  {\normalfont\normalsize\bfseries}}
\def\toclevel@subsubsubsection{4}
\def\toclevel@paragraph{5}
\def\toclevel@paragraph{6}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}
% --------------


\newcommand{\before}[1]{\textcolor{red}{#1}}
\newcommand{\after}[1]{\textcolor{green}{#1}}

\newcommand{\old}[1]{\textcolor{orange}{#1}}
\newcommand{\rem}[1]{\textcolor{red}{#1}}
\newcommand{\todo}[1]{\textcolor{orange}{\newline \textit{\textbf{TODO:} #1}} \newline \newline }

\makeatletter
\newcommand{\linebreakand}{%
  \end{@IEEEauthorhalign}
  \hfill\mbox{}\par
  \mbox{}\hfill\begin{@IEEEauthorhalign}
}
\makeatother




% ---------------------------


\begin{document}

\title{CybMASFM: A Formal Model for Cyberdefense Multi-Agent Systems\\
    % {\footnotesize \textsuperscript{Note}}
    % \thanks{Identify applicable funding agency here. If none, delete this.}
}

% \IEEEaftertitletext{\vspace{-1\baselineskip}}

\author{

    \IEEEauthorblockN{Julien Soulé}
    \IEEEauthorblockA{\textit{Thales Land and Air Systems, BU IAS}}
    %Rennes, France \\
    \IEEEauthorblockA{\textit{Univ. Grenoble Alpes,} \\
        \textit{Grenoble INP, LCIS, 26000,}\\
        Valence, France \\
        julien.soule@lcis.grenoble-inp.fr}

    \and

    \IEEEauthorblockN{Jean-Paul Jamont\IEEEauthorrefmark{1}, Michel Occello\IEEEauthorrefmark{2}}
    \IEEEauthorblockA{\textit{Univ. Grenoble Alpes,} \\
        \textit{Grenoble INP, LCIS, 26000,}\\
        Valence, France \\
        \{\IEEEauthorrefmark{1}jean-paul.jamont,\IEEEauthorrefmark{2}michel.occello\}@lcis.grenoble-inp.fr
    }

    % \and

    % \IEEEauthorblockN{Michel Occello}
    % \IEEEauthorblockA{\textit{Univ. Grenoble Alpes,} \\
    % \textit{Grenoble INP, LCIS, 26000,}\\
    % Valence, France \\
    % michel.occello@lcis.grenoble-inp.fr}

    \and

    \IEEEauthorblockN{Paul Théron}
    \IEEEauthorblockA{
        \textit{Co-leader of the IST-152 OTAN, 1st president of the AICA IWG} \\
        La Guillermie, France \\
        %lieu-dit Le Bourg, France \\
        paul.theron@orange.fr}

    % \linebreakand

    \and

    \IEEEauthorblockN{Louis-Marie Traonouez}
    \IEEEauthorblockA{\textit{Thales Land and Air Systems, BU IAS} \\
        Rennes, France \\
        louis-marie.traonouez@thalesgroup.com}}


\maketitle

\begin{abstract}

    Collaboration among cyber-defender agents in a networked host system is a promising approach to tackle cyber-attacks as close as entry points. Indeed, cyber-defense agents that are making up a cyber-defense Multi-Agent System with a flexible organization could handle scalability and adaptivity issues relying on self/re-organization mechanisms. Yet, before empirically trying to implement it, we aim to frame the problem of organization as the design of cyber-defense agents that have to collaborate to reach a cyber-defense goal under the deployment environment constraints; and the means to solve that problem as organizational mechanisms such as multi-agent paradigms or multi-agent deep learning algorithms.
    The paper deals with a general formal model that aims to help framing the design of a cyber-defense multi-agent system by positioning it in related works of cyber-defense, multi-agent systems and reinforcement learning domains.

\end{abstract}

\begin{IEEEkeywords}
    cyberdefense, multi-agent systems, reinforcement learning, organization, formal
\end{IEEEkeywords}

\section{Introduction}

As stated within \textquote{Autonomous Intelligent cyber-defense Agents} works\cite{kott2023autonomous}, the increasing complexity of cyber-threats and the limitations of centralized cyber-defense systems have led to fostering a multi-agent approach of cyber-defense. In this approach, the cyber-defender agents are making up a cyber-defense Multi-Agent System (CMAS). We think this Multi-Agent System (MAS) can only be envisioned in a scenario as blue team that aims to achieve cyber-defense goals to fight against a red team of cyber-attacker agents and tackle their impact on the networked environment and regular users represented as a green team.

Consequently, the design of a CMAS should be made considering a scenario to be ultimately implemented. Yet, a direct empiric implementation of a scenario to assess various CMAS types, may skip important prior theoretical considerations as for the specific problem to be set up in the scenario and the theoretical means to address and solve it. Indeed, not only do we need to realistically and consistently describe and design the networked host environment, the blue, red and green teams; but we also need to theoretically apprehend the scenario when teams are operating ultimately giving means to apprehend and generalize the role of CMAS organization on various scenarios.

In a MAS, we refer to organization among agents as the set of their respective individual behavior whose the collective action impacts the distance expressing how far agents are from their common goal for anytime. We assume research in CMAS is mainly focusing on finding an organization that allows agents being the closest as possible to their common cyber-defense goal at given points.

% A theoretical scenario refers to a set of abstract descriptions or models defining at least partially each component of a scenario. Moreover, we assume a theoretical scenario can always be mapped to real scenarios where the components are real software or hardware assets relying on available hardware and software technology. We refer to development as the whole process allowing real scenarios to be obtained from a theoretical scenario. Therefore, research in CMAS requires developing theoretical scenarios to get some feedback of various organizations among cyber-defender agents.

Currently, we did not identify any directly usable work as for comprehensively modeling such a scenario as it requires considering both a Multi-Agent Systems (MAS) designing point-of-view for agents teams and a cyber-defense point-of-view for the networked environment, attacks and countermeasures.
Gaps between these two point-of-views shows the development of a CMAS lacks of consistent central models to design scenarios, implement and monitor them in simulation or emulation, and analyze results as their organizations.

Our main contribution is the Cyberdefense Multi-Agent Systems Formal Model (CybMASFM) comprising both a formal view of CMAS in a scenario to be used to build realistic models for later implementation, and theoretical means to apprehend its interactions and the key role of organization in various operating CMAS.

\input{tables/CMAS_formal_model_review.tex}

In section II, we first exposed an informal overview of our vision of an operating CMAS showing how related works in cyber-defense, multi-agent and machine learning domains are thought to be key means to envision scenarios.
In section III, we introduced the fundamentals of the CybMASFM as an integrative formal model to describe a scenario so that a CMAS can be positioned within a same design space; also enabling thorough analysis and comparison between various CMAS types on scenarios.
In section IV, we detailed how CybMASFM integrates cyber-defense and cyber-attack frameworks, Multi-Agent Reinforcement Learning (MARL) algorithms and MAS mechanisms to design blue, green and red teams actions, observations, behavior and rewards.
In section V, we proposed a new approach to envision organization combining classical MAS mechanisms with MARL to unify bottom-up and top-down design approaches showing any point-of-view ranging between these two extrema can be envisioned in CybMASFM.
In section VI, we proposed using CybMASFM to model drone swarm scenarios coming from the third CAGE Challenge\cite{cage_challenge_3_announcement}. We characterized the scenario models as for deployment environment, blue and red teams objectives and organizations for ten of the proposed solutions. We showed CybMASFM can be used to consistently analyze relations between environment, objectives and organization of a CMAS.
In section VII, we concluded on the viability of CybMASFM also showing identified limitations we aim to overcome as perspectives for a wider utility.


\section{Related works}

We identified works that partially rely on modeling the scenario of a CMAS considering both a MAS designing point-of-view for agent teams and a cyber-defense point-of-view for the networked environment, attacks, and countermeasures. Formally, we first conducted a research of works according to the following boolean keywords: ("cyber-attack" or "cyber-defense") or "model" or "simulation" or "agent". Selected works implying a model dealing with the equivalent of red, blue or green in a networked system, were further analyzed with respect to 10 criteria onto the model:

\begin{itemize}
    \item Formal: Is the model relying on any formalism?
    \item General: Is the model applicable in generic scenarios?
    \item Designed for implementation: Is the model a medium to be used during implementation?
    \item Designed for Green Team: Does the model integrate the regular users?
    \item Designed for Blue Team: Does the model integrate the cyberdefense?
    \item Designed for Red Team: Does the model integrate the cyber-attacks
    \item Fidel to reality: Is the model close to real cyber-attack, countermeasures
    \item Used for experiments: Have experiments used the model as a medium?
    \item Designed for organization analysis: Does the model provide means to analyze and design organization in for the blue team?
    \item Designed for MARL: Is the model usable to apply RL algorithms for red and blue teams?
\end{itemize}

Only 16 considered works cover more than one the criteria. Results are summarized in Table \ref{tab:cmas_formal_model_review}.

From results, we observed most of available works do not meet all of the criteria especially as for having both a model to be used in implementation and in a general way. Moreover, almost none of the selected works cover the need to analyze the organization among agents. In a more general way, we consider 4 categories of works: the specific applicative models, the simulation models, the emulation models, the general frameworks. Here we present some representative works for each category.

% "Defensive Swarm: An Agent Based Modeling Analysis" deals with an agent-based computer simulation model for tactical problem of defending against enemies' attacks. It takes into account interaction between defenders and enemies\cite{padgett2017defensive}.

% "Autonomous Intelligent Cyber-defense Agent (AICA) Reference Architecture, Release 2.0" deals with architecture model for Intelligent software agents performing active, largely autonomous cyber-defense actions on military networks\cite{kott2018autonomous}.

% "Employment of Intelligence, Surveillance, and Reconnaissance Drone swarms to enhance ground combat operations" deals with modeling and simulation of drone swarm architecture in a combat scenario\cite{gulosh2018employment}.

% "D-CEWS: DEVS-Based Cyber-Electronic Warfare M\&S Framework for Enhanced Communication Effectiveness Analysis in Battlefield" deals with wargame models using agent-based modeling. It takes into account actor's attack and defense state components within the cyber-electronic warfare-based battlefield scenario\cite{Seo2022-ai}.

% "Multi-agent Modelling and Simulation of Cyber-Attacks and Cyber-Defense for Homeland Security" - This work presents an approach based on the agent-based simulation of cyber-attacks and cyber-protection mechanisms, combining discrete-event simulation, multi-agent modeling, and simulation for homeland security\cite{kotenko2007}.

"Internet of things security: A multi-agent-based defense system design" - The literature review in this work focuses on agent-based approaches in cyber defense and presents a multi-agent-based defense system design for the security of the Internet of Things, considering cyber-attacks and defense mechanisms\cite{aydin2023}.

"Extending a Multi-Agent Systems Simulation Architecture for Systems-of-Systems Security Analysis" - This document presents an approach for extending a multi-agent systems simulation architecture for systems-of-systems security analysis, including the manual derivation of risks and use case descriptions, which is relevant for cyber-defense scenario modeling\cite{elhachem2018}.

"An agent-based modeling framework for cybersecurity in mobile tactical networks" - This framework focuses on agent-based simulation as a modeling methodology for analyzing the effects of individuals' actions and interactions on a dynamic system, specifically in the context of cybersecurity in mobile tactical networks, which can be applied to the design and assessment of CMAS in various scenarios\cite{thompson2018}.

"Physical Safety and Cyber Security Analysis of Multi-Agent Systems: A Survey of Recent Advances" - This survey provides an overview of recent advances in the analysis of multi-agent systems, including their application to cyber security, which can offer valuable insights for the theoretical and practical considerations of modeling CMAS for cyber-defense scenarios\cite{dan2021}.


\section{Fundamentals for a CMAS formal model}

The idea of a CMAS involves considering both the vision of MASs and their development and the world of cyber-defense in particular its constraints. However, reconciling these two areas leads to considering a priori two opposing points of view.

From the point of view of MAS towards Cyberdefense, the process of developing a CMAS could be envisaged as the extension of the multi-agent paradigm to Cyberdefense which would only be one area of application. This process would firstly be based on approaches, methods or models from the world of MASs which would need to be highlighted and adapted to respond to identified constraints and needs arising from Cyberdefense. For example, organizational paradigms applied to cyber-defense agents such as hierarchies, models based on markets, teams could be considered in this approach. The application of these organizational paradigms could make it possible to meet needs such as scaling up when increasing load, reactivity in detecting and responding to attacks, execution performance during implementation of countermeasures, etc.

From the point of view of Cyberdefense towards MASs, the process of developing a CMAS could be envisaged as taking advantage of capabilities from the multi-agent paradigm to increase the capabilities of Cyberdefense systems with the timely aim of face specific challenges and constraints. This process would emphasize the identification of the needs and constraints of the systems to be protected, which could be shown to be covered by the application of certain tailor-made multi-agent mechanisms. For example, in a cyber-defense system protecting an open network system, the problem of adapting the cyber-defense system to changes in network topology could be covered by the redundant deployment of autonomous protection agents as part of the cyber-defense system.

The approach of our vision in the development of a CMAS considers these two points of view in a complementary manner. First, the development of a CMAS could benefit from feedback from first attempts at creation and experimentation with an MAS approach to cyber-defense in order to understand the impact of multi-agent mechanisms to cover constraints and needs identified on several case studies. In doing so, it would contribute to enriching the known links between Cyberdefense constraints and multi-agent mechanisms for the Cyberdefense point of view towards MASs. The accumulated experiences and knowledge could allow the application of the cyber-defense point of view to MAS by directly advocating the multi-agent mechanisms to be considered to precisely cover the identified cyber-defense constraints and needs.

Our vision of development uses several approaches, terms, concepts and notions that it is necessary to formalize and rationalize in order to have a common and coherent framework in which it would make sense to rigorously present our vision of the development of an MAS of Cyberdefense. No current work is intentionally part of this approach to building a link between the multi-agent paradigm and cyber-defense. For this reason, we propose CybMASFM as a basic structure to understand and rigorously organize the concepts related to our vision of a CMAS and its development.

\subsection{Description of the framework}

CybMASFM is intended to be a structured and extensible base of concepts, notions, terms and approaches aimed at providing a common framework for the development of CMAS. This framework is designed as a foundation for creating, coordinating and managing autonomous agents that work together to protect computer networks, systems and data against various cyber-attacker agents.

\begin{figure*}[]
    \centering
    \includesvg[width=\textwidth]{figures/model_example_illustration.svg}
    \caption{An illustrative view of the simulation model}
    \label{fig:model_example_illustration}
\end{figure*}

The Dec-POMDP approach was chosen as a core abstract model because we are interested in modeling a network environment made up from \textit{nodes} on which cyber-attacker and cyber-defender \textit{agents} can be deployed to observe and act. These nodes can be described by a set of \textit{properties} related to processes, file systems, operating systems, hardware architecture, etc.

An agent is a software entity deployed on any host system as a daemon.
For example, its source code can be Python, Java, C/C++, etc and running on a Linux or Windows.
As any software program, it requires computing and memory resources such as CPU and RAM usage.
It is able to apply action such as reading, writing, modifying, executing files, sending commands, etc.
After applying action, an agent get observations such as file content, modification acknowledgement, command's output, etc.
Based upon these observations, a decision making process is played to choose the next action to play. That decision making process can range from very simple ones such as random or reactive to complex ones such as cognitive process, reinforcement learning, etc.

In game theory, that decision making process is called a "strategy" and is represented as a mathematical relation associating any situation to an action.
Furthermore, in Dec-POMDP formalism, that relation is also called "behavior" or "policy" and it associates observations to an action.

The \textit{observations} and \textit{actions} of the agents are conditioned by their own properties (including the properties known by them) and uncertainties. For example, reading a given file or remapping ports may require an elevated privilege level; or the reception of data from a physical sensor is not ensured at all times.
Each agent applying actions modifies the properties of one or more nodes. This changes the state of the environment, making the agents closer or farther from their objective.

In \cite{soule2023} we showed this modeling objective can be addressed using \textquote{Decentralized Partially Observable Markov Decision Process} (Dec-POMDP). It is a mathematical frameworks for mathematical modeling of decision-making problems in which agents interact with each other and in a stochastic environment~\cite{beynier2010}. In a Dec-POMDP, a group of agents interacts with a stochastic and partially observable environment. Several agents can have a common reward function and can coordinate their actions to achieve a common goal, especially by being able to communicate~\cite{bernstein2013}.
Then, we showed the key features of the assets we want to model are encompassing notions like uncertainty in observations, conditions in actions for state transitioning and metrics that we consider to be expressed the best within a Dec-POMDP modeling.

From a global view the proposed Dec-POMDP model expresses an environment state as the set of nodes properties including agents observable properties. We define a property as a couple made of an identifier and a value. The environment state is changed when an action is applied by an agent. An action can be applied only if the boolean property-based pre-condition is satisfied in the current environment state. The resulting state is then modified depending on post-condition ultimately leading some new properties to be added while some others are deleted. After an action is successfully applied by an agent, observable properties of the same agent are returned to it as observations from that new state. A reward is also computed based on the current state and returned to the agent. An agent is chosen to be modeled as a behavior function which has to select the next action to be made depending on received observations and rewards.

There are different ways for several agents to be executed in a same environment tweaking with the number of agents to execute in a time step and the number of actions to be played by an agent in a time step. Even though not realistic, we chose the \textquote{Agent Environment Cycle}~\cite{jk2020} as a first approximation by having several agents playing one action in each turn in a sequential cyclic manner. The iteration cycle is presented through an illustrative informal view of the simulation model in Figure~\ref{fig:model_example_illustration}. It shows $i$ nodes with their properties including the $m$ agents' observed ones; and how each of the available $j$ actions associates a pre-condition set of properties subsets to a subset of new properties to be added in the environment optionally deleting obsolete properties having the same identifiers as the new properties' ones:

\begin{enumerate}
    \item An agent chooses an action from previous observations and rewards according to a behavior function. In Figure~\ref{fig:model_example_illustration}, as $Agent_1$ begins its first turn, it receives only initial observations ($p_{1}$) and zero rewards and chooses $Action_1$

    \item The environment is updated by a transition function depending on the current state and the action taken by the agent (change of properties once the pre-condition is satisfied). An action is used to change the environment properties by updating the relation between property identifiers and property values.
          For instance, in Figure~\ref{fig:model_example_illustration}, in current state, $Node_1$ properties are $p_1,p_3,p_4,p_2,p_9$. When $Action_1$ is applied, the relation associate subsets $\{p_3\}$ or $\{p_4, \allowbreak p_{10}\}$ to $\{p_{15}, \allowbreak p_{14}, \allowbreak p_{11}\}$. The property based pre-condition can be understood as $p_3 \lor (p_4 \land p_{10})$. As $p_{15}$ and $p_{14}$ are identified by $ID_4$ and $ID_2$ which already respectively define $p_{2}$ and $p_{4}$, $p_{4}$ and $p_{2}$ are deleted and $p_{11}$ and $p_{14}$ are added ($p_{15}$ is not added as $id_2$ is not associated with any value)

    \item Observed properties are returned to the current executor agent for its next turn. In Figure~\ref{fig:model_example_illustration} $p_{11}$ and $p_1$ are returned after $Action_1$ is applied.

\end{enumerate}

\

Agents are selected following a sequential order. Each one receives last observations and rewards from their last turn (or just initial observation and zero rewards if they are on their first turn); chooses the next action to play in its current turn. Once the last agent has finished playing (such as $Agent_m$), rewards are computed and sent to cyber-attackers and cyber-defenders based on the evaluation of the collected metrics from last state. Then, the agents play again following the same sequential order for another iteration.


\paragraph{Dec-POMDP formal description}

We set the elements related to the properties of the nodes, agents and actions of the following environment:

\begin{itemize}

    \item $Ag = \{ag_1,..,ag_{|Ag|}\}$: The set of the agents.
          \begin{itemize}
              \item With $RedAg \subseteq Ag$: The set of red agents
              \item With $BlueAg \subseteq Ag$: The set of blue agents
              \item With $GreenAg \subseteq Ag$: The set of green agents
          \end{itemize}

    \item We call the couple $p = (id_{j}, v_{j})$ with $id_j \in {ID}$ and $v_j \in V$, a property.
          \begin{itemize}
              \item $ID$: The set of property identifiers optionally indicating how are organized the properties in a non-flat data structure (such as $PC1.processes.agents.agent1$). These property identifiers may be used for a file path, the type of operating system used in a node, a used command line by an agent\dots
              \item $V$: The set of property values. These may include the content of a file, a full description of the operating system, the output result of a command line\dots
                    % \item $Values: ID \rightarrow \mathcal{P}(V) = \{(id_{j}, V_{j}) \: | \: id_j \in {ID},$ $V_j \in \mathcal{P}(V)\}$: a bijection associating a property identifier to the set of the different values it can be associated with. For instance, a the identifier $ls\_command\_output$ may be associated with the following values $\{file.txt,\{file.txt,passwd.txt\}\}$
          \end{itemize}

    \item $P_{j} = \{ p_1, .., p_{|P_{j}|} \}$: The set of the $p_{l}$ properties (with $l \in \{1,..,|P_{j}|\}$) of node $j$ ($j \in \mathbb{N} $). For example, such properties may include some running process IDs, files list in a folder, type of operating system with description, specific knowledge of an agent, etc.
          \begin{itemize}
              \item $P = P_1 \cup P_2 .. \cup P_{|P|} $: The set of all the node properties.
          \end{itemize}

    \item $Obs: \mathcal{P}(P) \times Ag \rightarrow \mathcal{P}(P_{Ag}), P_{Ag} \subset P$: A relation which associates node properties and an agent with the observed property subset by the agent.

    \item $Action: P_{pre} \rightarrow P_{post}$: A relation which associates a property subset implied by an equivalent conjunctive boolean pre-condition ($P_{pre} \subset \mathcal{P}(P)$) to a subset of all of the properties of the post-condition ($P_{post} \in \mathcal{P}(P)$). For example, the properties $p_1 = (agent\_X\_privilege\_level, \allowbreak root)$, $p_2 = (agent\_X\_accessed\_text\_editor, \allowbreak Vim)$ and $p_3 = (agent\_X\_bashrc\_known\_filepath, \allowbreak /home/user/.bashrc)$ can make a pre-condition ($p_1 \land p_2 \land p_3$) to associate a new set of property containing $p4 = (bashrc\_file\_modified\_by\_X\_agent, \top)$. Two pre-condition subsets can be associated to the same post-condition subset to model a boolean disjunction.

    \item $Metrics: \mathcal{P}(P) \times A \rightarrow \mathbb{R}^{n}$: Gives metrics associated with a set of properties and joint action. For example, the number of nodes still active, lateral moves, etc.

\end{itemize}


Using the formal description of a Dec-POMDP~\cite{OliehoekA16}, we propose the following model:

\begin{itemize}
    \item $S = \{s_1, ..s_{|S|}\}, s_{i} \subseteq P \: and \: 1 \le i \le |S|$: The space of states as possible property sets.

    \item $A_{i} = \{a_{i}^{1},..,a_{i}^{|A_{i}|}\}, a_{i}^j \in Action \: and \: 1 \le j \le |A_i|$: The set of possible actions for agent $i$.

    \item $T$ : The set of conditional transition probabilities between states
          \begin{itemize}
              \item With $T(s,a,s') = \probP(s'|s,a)$, the relation which associates probability to go to state $s' \in S$ from state $s \in S$ knowing we played $a = (P^a_{pre} \times P^a_{post}) \in A$ with $P^a_{pre} \subset \mathcal{P}(P)$ and $P^a_{post} \in \mathcal{P}(P)$
              \item With $\probP(s'|s,a) = 0$ if $s$ does not satisfy the pre-condition of $a$ (i.e $\exists \: P_{pre_s}^{a} \in P_{pre}^{a} \: | \: P_{pre_s}^{a} \not\in \mathcal{P}(s)$).
              \item With $s' = (s - \{p_l=(id_l, v_l) \: | \: p_l \in s \: and$ $id_l \in \{id_k \: | \: (id_k, v_k) \in P^a_{post} \: and \: v_k \neq \varnothing\}\}) \cup P^a_{post}$
          \end{itemize}

    \item $R: S \times A \rightarrow \mathbb{R}^2 = Eval \circ Metrics$: The reward function that takes a state and an action and associates a performance indicator (using the state's metrics) for attackers and defenders.
          \begin{itemize}
              \item With $Eval: \mathbb{R}^{n} \rightarrow \mathbb{R}^2$, associates a metric vector to a a reward for cyber-attackers and cyber-defenders.
          \end{itemize}

    \item $\Omega_{i} \subset Range(Obs \: | \: \{ (s, ag_i) | s \in S \: and \: ag_i \in Ag \}) \subset P$: The set of observable properties for agent $ag_i$. For example, the content of a file, the log output of a command, the result of a port scan, etc.
          \begin{itemize}
              \item $\Omega = \Omega_1 \cup \Omega_2 .. \cup \Omega_{|Ag|} = Range(Obs)$: The set of all the observable properties for all agent.
          \end{itemize}

    \item $O$ : The set of conditional observation probabilities.
          \begin{itemize}
              \item With $O(s',a,o) = \probP(o|s',a)$, the relation which associates the probability to observe an observation $o \subset \Omega$ from state $s' \in S$ induced by $a \in A$
              \item With $\probP(o|s',a) = 0$ if the state $s' \in S$ does not contain the properties of $o \subset \Omega$ (i.e $o \not\in \mathcal{P}(s')$). For example, an agent plays the action $x\_reads\_a\_log\_file$, a new state results from which a property belonging to the knowledge of agent x is $(log\_file\_content\_known\_by\_x, \allowbreak abc)$. This property will be therefore included in the returned observations to agent x.
          \end{itemize}

\end{itemize}


\section{An integrative model for methodological purposes}

Upon the core modeling, we built our scenario model proposing approaches and definitions to envision thoroughly key notions and concepts for both Cyberdefense, MARL and MAS fields.

\subsection{Links with MAS and Cyberdefense key concepts}

\begin{itemize}
    \item Behavior: maps observations to actions
    \item Observed behavior: mapping obtained from observed actions played after receiving observations
    \item Constant behavior: the mapping from observations to actions does not change over time. This may be the case for most behaviors relying on organization schema.
    \item Inconstant behaviors: the mapping from observations to actions does change over time. This may be the case for most behaviors relying on learning.
    \item Organization: refers to the set of all agents' behaviors at a given time. Indeed, we consider the sum of individual behaviors to describe the whole MAS as for its internal functioning.
    \item Organizational paradigm / architecture: refers to a set of requirements an organization has to comply with at any time. For instance, a hierarchy architecture would require that at some point, some agents' behaviors to play actions such as sending commands to some other agents; and these latter agents would receive these as observations that trigger the playing of specific actions.
    \item Hierarchy organization:
    \item Market-based organization:
    \item Teams organization:
    \item Coalitions organization:
    \item Multi-Agent Reinfocement Learning (MARL): refers to the process for a MAS to change its organization to improve the cumulative reward over an episode. MARL opens various approaches for several agents to have their behaviors suited to collaboratively reach their common goal.
    \item Online MARL: refers to the process for a MAS apply MARL without any external modification in agents' behaviors. It may consists in providing agents capabilities so they can apply MARL while they are running.
    \item Offline MARL: refers to the process for a MAS to apply MARL through external modifications in agents' behaviors. It may consists in relying on some simulation tool allowing to change agents' behaviors to apply MARL since they can not apply it by themselves.
    \item Organization stability: for a MAS, for a given time period, it refers to similarity between all of the possible organizations in that time period. The similarity expresses the number of identical relation between observations and actions in mappings for each agents' behavior.
    \item Self-organization: refers to the process for a MAS to have its organization changed over time to reach a stable organization at some point while agents' behaviors are individually defined with no expectation as for the emergent stable organization.
    \item Re-organization: refers to the process for a MAS to have its organization changed over time to reach a stable organization at some points while agents' behaviors are individually defined in a way one can precisely guarantee the possible emergent stable organizations comply with expected architectures.
    \item Communication: refers to the process for an emitter agent to play the abstract action \textquote{send message to a receiver agent}. The receiver agent considers the received message as an observation.
    \item Protocols: refers to the frame communication fits in as for extending the abstract action \textquote{send message to a receiver agent}. This may involve following particular steps between emitter and receiver or complying with specific frames in messages.
    \item Cooperation: involves working with others to help them achieve their individual goals.
    \item Collaboration: addresses situations in which people work together on a shared goal,
    \item Flexible/Inconstant organization: refers to any organization whose one of the agents' behavior is not inconstant.
    \item Constant organization: refers to any organization whose all of the agents' behaviors are constant.
    \item Individual goal: for a agent, it refers to any description encompassing the respect of the constraints which are directly related to itself.
    \item Common goal: for several agent, it refers to any description encompassing the respect of the constraints which are common between themselves.
    \item Metrics: for any goal, it refers to a way to express the respect of constraints as a set of numerical values for each constraint.
    \item Location (in the network): refers to the location of the physical computer an agent is deployed on in the whole network.
    \item Located self/re-organization: refers to self/re-organization augmented with the possibility for agents to change their location while the MAS organization is changing.
    \item Organization centered point of view: refers to the process of defining agents' behavior individually in a way one can precisely guarantee the possible emergent stable organizations comply with expected architectures.
    \item Agent centered point of view: refers to the process of defining agents' behavior individually defined with no expectation as for the emergent stable organization.
\end{itemize}


\subsection{Building spaces}

The proposed Dec-POMDP modeling\cite{soule2023} allows any scenario to be defined in it for it only requires defining observations, actions, behaviors and reward functions for agents; and state transition and observation transition functions for the networked environment.
From this point, as these elements are to be implemented, we suggest the possible choices of implementation can indeed fit within some predefined general structures for each element. With the help of Cyberdefense and cyber-attack general knowledge and various scenario implying different cyber-attack and cyber-contexts, we generalized how implementation of actions, observations, reward functions can be envisioned through general structures. This preliminary work led to view CybMASFM as a ready-to-use general framework relying on the Dec-POMDP model that is to be filled-in to define a scenario model.
A informal overview of CybMASFM is presented in Table \ref{tab:scenario_model}.

\input{tables/scenario_model}

This framework includes a set of definitions, standards, norms, models and rules that we propose to adopt as a reference framework for all future work related to the development of a CMAS.

We refer to the cyber-attacker and cyber-defender agents fighting each other in a host nodes networked environment as a \textbf{scenario model}. On one hand, a scenario model is required to frame a formal description of the environment, the agents and how they interact with environment and each other. On the other hand, a scenario model is required to be used as a common basis for a method to develop a CMAS.

A theoretical scenario refers to a set of abstract descriptions or models defining at least partially each component of a scenario. Moreover, we assume a theoretical scenario can always be mapped to real scenarios where the components are real software or hardware assets relying on available hardware and software technology. We refer to development as the whole process allowing real scenarios to be obtained from a theoretical scenario. Therefore, research in CMAS requires developing theoretical scenarios to get some feedback of various organizations among cyber-defender agents.

We refer to organization among agents as the set of their respective individual behavior whose the collective action impacts the distance expressing how far agents are from their common goal for anytime. We assume research in Cyberdefense Multi-Agent System is mainly focusing on finding an organization that allows agents being the closest as possible to their common Cyberdefense goal at given points.

% TODO : Move in formal description to enrich examples
\begin{itemize}
    \item Network environment % Describe what it could be in concrete terms: Windows, Linux, servers, databases, network interfaces, etc
    \item Network links % Describe what this may involve in concrete terms: Sub-networks, firewalls, etc.
    \item Agent teams % Describe where it comes from (ACO), why it is relevant, etc.
          \begin{itemize}
              \item Blue team
              \item Red team
              \item Green team
          \end{itemize}
    \item Agents % What is it concretely ? Script, daemon ?
    \item Observations % Make a link with the frameworks NIST, MITRE, OpenC2, Théron diagram dealing with observations
          \begin{itemize}
              \item Red Observations % Red: nmap, exploits, etc.
              \item Blue Observations % depends on observation rights, etc.
              \item Green Observations
          \end{itemize}
    \item Actions % Make a link with the frameworks NIST, MITRE, OpenC2, Théron diagram dealing with actions
          \begin{itemize}
              \item Red Actions % bruteforce,.
              \item Blue Actions % change configuration, misinform, etc.
              \item Green Actions % send data, establish connections, etc.
          \end{itemize}
\end{itemize}

// elements of the Dec-POMDP model of the publication
P1, node properties
O, set of observations
A, set of actions
Ag, set of agents
B: P(O) -> A, all behaviors
Metrics: N -> P(P)
Rb = Evalb ° Metricsb
Rr = Evalr ° Metricsr
Rg = Evalg ° Metricsg
N, the properties of the network made up of the properties of the nodes
Agb, Blue Agents
Agr, Red Agents
Agg, Green Agents
S = N x Ar x Ab x Ag, all scenarios

GOAL: max(sum(Rb(S)))
State value function
Action value function

Scenarios
Describe the possible scenario space
Explain that studying typical scenarios is a good approach to cover a significant space of all possible scenarios


\subsection{Usage range and perimeter}

CybMASFM is designed to provide a common framework for several actors involved in the development of multi-agent cyber-defense systems. To this end, our framework aims to meet several of their needs:
\begin{itemize}
    \item Development: Providing a structured environment for developers, reducing the need to build each component from scratch. This simplifies development and speeds up the creation of software applications.
    \item Standardization: encourage best practices, design patterns and coding conventions. This standardization ensures that developers follow established guidelines, which leads to more consistent and more easily maintainable code.
    \item Code reuse: Include pre-written, reusable code and libraries, allowing developers to leverage existing components for common functionality such as authentication, database access, and application design. user interface. This saves time and effort.
    \item Modularity: encourage a modular approach to development, making it easier to maintain and extend the software. Developers can work on individual modules without affecting the entire application.
    \item Security: Integrate security features and built-in mechanisms to protect against common vulnerabilities, reducing the risk of security breaches in applications.
    \item Scalability: Make it easier to add new features and support a growing user base and increased data volumes.
    \item Cross-platform development: Allow developers to create apps that work across multiple operating systems and devices with few changes.
    \item Performance Optimization: Include built-in performance optimization features, such as caching mechanisms and code profiling tools, to help developers create efficient, high-performance applications.
    \item Rapid Application Development (RAD): Accelerate the development process, enabling rapid creation of prototypes and production-ready applications.
    \item Maintenance and Updates: Simplify the process of maintaining and updating software. When security vulnerabilities or bugs are discovered, updates and patches are often available from the framework maintainers.
    \item Consistent User Experience: Include pre-built UI components and design guidelines, which helps developers create apps with a consistent look and feel, improving user experience.
    \item Integration: Integrate with other software components, services, and APIs, making it easy to connect your application to external resources.
    \item Testing and Debugging: Offer tools and utilities for automated testing, debugging and error handling, simplifying the development and quality assurance process.
    \item Documentation: Provide comprehensive documentation and resources to help developers understand how to use the framework effectively.
\end{itemize}

\subsection{Actors concerned by the framework}

% Who? Who are the persons or entities likely to use the framework?

In the process of developing a CMAS, our framework is aimed at stakeholders needing a coherent common framework to define, design, analyze, compare and discuss different CMASs. Our framework targets actors who can be human or software entities who adopt the role with the following associated functions as discussed in \cite{jamont2005diamond}:

\begin{itemize}
    \item Requester: Identify Cyberdefense constraints and the network environment constraints.
    \item User : Rely on provided structures and media to help in understanding the network environment with cyber-attacker and cyber-defender agents
    \item Expert: Give an opinion in analysing Cyberdefense or MAS constraints and environment thanks to one's knowledge
    \item Analyst: Provide an analysis of the network environment and Cyberdefense constraints and needs for the development of a CMAS.
    \item Designers: Person who designs the application
\end{itemize}

More than focusing on particular person, the framework mostly aims at providing support in the proposed functions. For instance, \textquote{Requesters} may rely on the provided guidelines to identify Cyberdefense and network environment constraints.

\subsection{Provided means to use the framework}

% How? How to use this framework? What are the provided means to apply it?

Our framework suggest using several media, forms to be used to describe the component of a scenario especially the actions, observations, agents' behaviors, reward functions and the network environment.
In our framework we also suggest approaches to implement these component linking them to knowledge base.


\paragraph{Attack-Defense trees}

Attack-Defense trees~\cite{BKordy2010} (AD trees) are graphical models representing the attacker's goals and the defender's countermeasures as a tree structure. AD trees provide a more abstract representation of the system and the attackers goals, while attack graphs provide a more concrete representation of the system's components and their relationships. The root of the tree represents the cyber-attackers' ultimate goal. The associated sub-nodes of the branches represent different attack strategies that the attacker might use to achieve their goal. They can be decorated with preventive or reactive defender's countermeasures (firewalls, intrusion detection systems, incident response plans\dots).
AD trees allow identifying the weakest points in a system's defense~\cite{BKordy2010}.

\paragraph{Scenario requirements forms}

\paragraph{Scenario model}

\paragraph{Network topology model}

\paragraph{Goal oriented reward model}

\paragraph{Attack/defense scenarios integration}
From a raw perspective, the proposed formal Dec-POMDP modeling relies on actions to simulate how a real networked system would react including vulnerabilities and countermeasures applied by cyber-attacker and cyber-defender agents.

A first challenge is to build a representative attack/defense scenario of a networked system comprising vulnerabilities to allow rendering an attack by linking the only available pieces of information (such as known tactics, techniques and procedures from MITRE ATT\&CK) and by choosing relevant defense countermeasures (from MITRE ATT\&CK mitigations) and a deployment environment. A second challenge is to establish the actions to match the attack/defense scenario. As actions modify the environment properties, they also impact possible states space and the transitions between them.
Moreover, when considering a low abstraction level, numerous simple actions may allow describing the operated changes in the network finely. Yet, doing so increases the number of actions, and even more the number of states for they are combinations of action effects.

These challenges are directly linked to studied issues about automated generation of attack graphs using available databases optionally integrating artificial intelligence techniques as in ~\cite{GFalco2018}. We do not intend to focus more on these issues as they are out of the scope of this work.

\

\noindent
\textbf{MITRE ATT\&CK integration approach}: We suggest a high-level manual approach we used to integrate MITRE ATT\&CK information as an AD tree for it formalizes actions to be played in a scenario and their interactions with the environment. It is aimed at being helpful to establish the attack/defense actions to be finally integrated in the simulator:

\begin{enumerate}

    \item For a given Advanced Persistent Threat (APT), we identified relevant tactics and techniques and procedures from MITRE ATT\&CK that seemed relevant for a networked system

    \item We produced a description linking identified tactics together and associated techniques, sub-techniques and procedures to create a scenario that describes how the APT group could attack the networked system. This step defines the network topology with its main properties (such as a company network made up of several dedicated database servers communicating through FTP and HTTP, etc.)

    \item We created an AD tree as proposed in ~\cite{BKordy2010} with tactics as top action goals while techniques, sub-techniques and procedures are in the lower part of the tree. We made sure to have several paths to reach a same top-action goal. We paid attention to define each attack action with property based pre-condition and property post-conditions in the environment

    \item We extracted the MITRE ATT\&CK techniques/sub-techniques related detection and mitigations we added in the AD tree to decorate the attack nodes. We paid attention to define each defense actions with property based pre-condition and property post-conditions in the environment.

    \item We also listed and defined the main deployment specific environmental actions from deployment environment previous description or extended attack/defense actions which are common to both cyber-defenders and cyber-attackers. This step brings a more realistic environment providing a representative number of plausible actions an agent can choose in many systems.
          These common actions could include at least:
          \begin{itemize}
              \item Reading and writing files
              \item Creating, deleting, copying, moving, renaming, modifying properties of files/folders.
              \item Go into a folder, go to the parent folder
              \item Focusing a file/folder for applying future actions
              \item Execute binary file
              \item Using network protocol (such as HTTP, FTP, SSH, etc.).
              \item Some other interactions with basic command lines about system monitoring or controlling.
          \end{itemize}
          Then, associated environmental properties should describe a file system, a terminal interface, port with rules, operating system parameters properties, etc.

\end{enumerate}


\section{A general formal approach of organization}

In previous section, we proposed to view some MAS organization related concepts through the Dec-POMDP formalism to integrate MAS domain within CybMASFM. Yet, that static description of organization and mechanisms is not sufficient for designing organization.

We based our vision of organization considering four typical cases of organization between OCPV/ACPV and awareness/unawareness of organization\cite{picard2009reorganisation}:

\begin{itemize}
    \item Emergent MAS: Organization only exists as an emergent phenomena and is the result of interpretation between agents interactions over time. This is a bottom-up process.
    \item Coalition based MAS: Interactions between agents in thought within agents themselves but global picture of the organization is shared among all agents. Indeed, organization results from cooperation schemes. This is a bottom-up process.
    \item Agent-Oriented Engineering: Organization is thought during designing but agents are not aware for they are hard coded within agents themselves. This is a top-down process.
    \item Organization oriented MAS: Organization is thought commonly between all agents as they share the same organization representation.
\end{itemize}

Here we aim to unify the designing processes of organization in MAS through the CybMASFM model.


\section{Case study in drone swarm scenarios}


\section{Conclusion}


\section*{References}

% \bibliographystyle{abbrv}
\bibliographystyle{IEEEtran}

\bibliography{references}

\end{document}
